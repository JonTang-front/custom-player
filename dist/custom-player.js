!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SZPlayer=t():e.SZPlayer=t()}(this,(function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=102)}([function(e,t,i){var r=i(30)("wks"),n=i(18),s=i(1).Symbol,o="function"==typeof s;(e.exports=function(e){return r[e]||(r[e]=o&&s[e]||(o?s:n)("Symbol."+e))}).store=r},function(e,t){var i=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(e,t,i){"use strict";var r,n="object"==typeof Reflect?Reflect:null,s=n&&"function"==typeof n.apply?n.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};r=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var h=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,i,r){var n,s,o,a;if(l(i),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),s=e._events),o=s[t]),void 0===o)o=s[t]=i,++e._eventsCount;else if("function"==typeof o?o=s[t]=r?[i,o]:[o,i]:r?o.unshift(i):o.push(i),(n=u(e))>0&&o.length>n&&!o.warned){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=o.length,a=h,console&&console.warn&&console.warn(a)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,i){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},n=c.bind(r);return n.listener=i,r.wrapFn=n,n}function _(e,t,i){var r=e._events;if(void 0===r)return[];var n=r[t];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(n):p(n,n.length)}function m(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function p(e,t){for(var i=new Array(t),r=0;r<t;++r)i[r]=e[r];return i}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");h=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var h=n[e];if(void 0===h)return!1;if("function"==typeof h)s(h,this,t);else{var l=h.length,u=p(h,l);for(i=0;i<l;++i)s(u[i],this,t)}return!0},a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){return l(t),this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,f(this,e,t)),this},a.prototype.removeListener=function(e,t){var i,r,n,s,o;if(l(t),void 0===(r=this._events))return this;if(void 0===(i=r[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(n=-1,s=i.length-1;s>=0;s--)if(i[s]===t||i[s].listener===t){o=i[s].listener,n=s;break}if(n<0)return this;0===n?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,n),1===i.length&&(r[e]=i[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,i,r;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var n,s=Object.keys(i);for(r=0;r<s.length;++r)"removeListener"!==(n=s[r])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return _(this,e,!0)},a.prototype.rawListeners=function(e){return _(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,i){e.exports=!i(9)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,i){var r=i(11),n=Math.min;e.exports=function(e){return e>0?n(r(e),9007199254740991):0}},function(e,t,i){var r=i(10),n=i(24);e.exports=i(3)?function(e,t,i){return r.f(e,t,n(1,i))}:function(e,t,i){return e[t]=i,e}},function(e,t,i){var r=i(7);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,i){var r=i(1),n=i(16),s=i(5),o=i(17),a=i(13),h=function(e,t,i){var l,u,d,c,f=e&h.F,_=e&h.G,m=e&h.S,p=e&h.P,g=e&h.B,v=_?r:m?r[t]||(r[t]={}):(r[t]||{}).prototype,y=_?n:n[t]||(n[t]={}),E=y.prototype||(y.prototype={});for(l in _&&(i=t),i)d=((u=!f&&v&&void 0!==v[l])?v:i)[l],c=g&&u?a(d,r):p&&"function"==typeof d?a(Function.call,d):d,v&&o(v,l,d,e&h.U),y[l]!=d&&s(y,l,c),p&&E[l]!=d&&(E[l]=d)};r.core=n,h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,h.U=64,h.R=128,e.exports=h},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,i){var r=i(6),n=i(38),s=i(29),o=Object.defineProperty;t.f=i(3)?Object.defineProperty:function(e,t,i){if(r(e),t=s(t,!0),r(i),n)try{return o(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(e[t]=i.value),e}},function(e,t){var i=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:i)(e)}},function(e,t){var i={}.hasOwnProperty;e.exports=function(e,t){return i.call(e,t)}},function(e,t,i){var r=i(20);e.exports=function(e,t,i){if(r(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,r){return e.call(t,i,r)};case 3:return function(i,r,n){return e.call(t,i,r,n)}}return function(){return e.apply(t,arguments)}}},function(e,t){var i={}.toString;e.exports=function(e){return i.call(e).slice(8,-1)}},function(e,t,i){var r=i(25);e.exports=function(e){return Object(r(e))}},function(e,t){var i=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=i)},function(e,t,i){var r=i(1),n=i(5),s=i(12),o=i(18)("src"),a=i(62),h=(""+a).split("toString");i(16).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,i,a){var l="function"==typeof i;l&&(s(i,"name")||n(i,"name",t)),e[t]!==i&&(l&&(s(i,o)||n(i,o,e[t]?""+e[t]:h.join(String(t)))),e===r?e[t]=i:a?e[t]?e[t]=i:n(e,t,i):(delete e[t],n(e,t,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[o]||a.call(this)}))},function(e,t){var i=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+r).toString(36))}},function(e,t){e.exports=!1},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,i){var r=i(31),n=i(25);e.exports=function(e){return r(n(e))}},function(e,t,i){var r=i(14),n=i(0)("toStringTag"),s="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,i,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),n))?i:s?r(t):"Object"==(o=r(t))&&"function"==typeof t.callee?"Arguments":o}},function(e,t){e.exports={}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,i){var r=i(11),n=Math.max,s=Math.min;e.exports=function(e,t){return(e=r(e))<0?n(e+t,0):s(e,t)}},function(e,t,i){var r=i(10).f,n=i(12),s=i(0)("toStringTag");e.exports=function(e,t,i){e&&!n(e=i?e:e.prototype,s)&&r(e,s,{configurable:!0,value:t})}},function(e,t,i){var r=i(7),n=i(1).document,s=r(n)&&r(n.createElement);e.exports=function(e){return s?n.createElement(e):{}}},function(e,t,i){var r=i(7);e.exports=function(e,t){if(!r(e))return e;var i,n;if(t&&"function"==typeof(i=e.toString)&&!r(n=i.call(e)))return n;if("function"==typeof(i=e.valueOf)&&!r(n=i.call(e)))return n;if(!t&&"function"==typeof(i=e.toString)&&!r(n=i.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t,i){var r=i(16),n=i(1),s=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:i(19)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,i){var r=i(14);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,i){var r=i(30)("keys"),n=i(18);e.exports=function(e){return r[e]||(r[e]=n(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,i){var r=i(17);e.exports=function(e,t,i){for(var n in t)r(e,n,t[n],i);return e}},function(e,t){e.exports=function(e,t,i,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(i+": incorrect invocation!");return e}},function(e,t,i){var r=i(6),n=i(20),s=i(0)("species");e.exports=function(e,t){var i,o=r(e).constructor;return void 0===o||null==(i=r(o)[s])?t:n(i)}},function(e,t,i){"use strict";var r,n,s=i(85),o=RegExp.prototype.exec,a=String.prototype.replace,h=o,l=(r=/a/,n=/b*/g,o.call(r,"a"),o.call(n,"a"),0!==r.lastIndex||0!==n.lastIndex),u=void 0!==/()??/.exec("")[1];(l||u)&&(h=function(e){var t,i,r,n,h=this;return u&&(i=new RegExp("^"+h.source+"$(?!\\s)",s.call(h))),l&&(t=h.lastIndex),r=o.call(h,e),l&&r&&(h.lastIndex=h.global?r.index+r[0].length:t),u&&r&&r.length>1&&a.call(r[0],i,(function(){for(n=1;n<arguments.length-2;n++)void 0===arguments[n]&&(r[n]=void 0)})),r}),e.exports=h},function(e,t,i){e.exports=!i(3)&&!i(9)((function(){return 7!=Object.defineProperty(i(28)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,i){var r=i(40),n=i(33);e.exports=Object.keys||function(e){return r(e,n)}},function(e,t,i){var r=i(12),n=i(21),s=i(41)(!1),o=i(32)("IE_PROTO");e.exports=function(e,t){var i,a=n(e),h=0,l=[];for(i in a)i!=o&&r(a,i)&&l.push(i);for(;t.length>h;)r(a,i=t[h++])&&(~s(l,i)||l.push(i));return l}},function(e,t,i){var r=i(21),n=i(4),s=i(26);e.exports=function(e){return function(t,i,o){var a,h=r(t),l=n(h.length),u=s(o,l);if(e&&i!=i){for(;l>u;)if((a=h[u++])!=a)return!0}else for(;l>u;u++)if((e||u in h)&&h[u]===i)return e||u||0;return!e&&-1}}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,i){var r=i(8);r(r.S+r.F*!i(3),"Object",{defineProperty:i(10).f})},function(e,t,i){for(var r,n=i(1),s=i(5),o=i(18),a=o("typed_array"),h=o("view"),l=!(!n.ArrayBuffer||!n.DataView),u=l,d=0,c="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");d<9;)(r=n[c[d++]])?(s(r.prototype,a,!0),s(r.prototype,h,!0)):u=!1;e.exports={ABV:l,CONSTR:u,TYPED:a,VIEW:h}},function(e,t,i){var r=i(11),n=i(4);e.exports=function(e){if(void 0===e)return 0;var t=r(e),i=n(t);if(t!==i)throw RangeError("Wrong length!");return i}},function(e,t,i){var r=i(40),n=i(33).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,n)}},function(e,t,i){"use strict";var r=i(15),n=i(26),s=i(4);e.exports=function(e){for(var t=r(this),i=s(t.length),o=arguments.length,a=n(o>1?arguments[1]:void 0,i),h=o>2?arguments[2]:void 0,l=void 0===h?i:n(h,i);l>a;)t[a++]=e;return t}},function(e,t,i){var r=i(23),n=i(0)("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||s[n]===e)}},function(e,t,i){var r=i(6),n=i(68),s=i(33),o=i(32)("IE_PROTO"),a=function(){},h=function(){var e,t=i(28)("iframe"),r=s.length;for(t.style.display="none",i(50).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),h=e.F;r--;)delete h.prototype[s[r]];return h()};e.exports=Object.create||function(e,t){var i;return null!==e?(a.prototype=r(e),i=new a,a.prototype=null,i[o]=e):i=h(),void 0===t?i:n(i,t)}},function(e,t,i){var r=i(1).document;e.exports=r&&r.documentElement},function(e,t,i){var r=i(12),n=i(15),s=i(32)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=n(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,i){var r=i(22),n=i(0)("iterator"),s=i(23);e.exports=i(16).getIteratorMethod=function(e){if(null!=e)return e[n]||e["@@iterator"]||s[r(e)]}},function(e,t,i){var r=i(0)("iterator"),n=!1;try{var s=[7][r]();s.return=function(){n=!0},Array.from(s,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!n)return!1;var i=!1;try{var s=[7],o=s[r]();o.next=function(){return{done:i=!0}},s[r]=function(){return o},e(s)}catch(e){}return i}},function(e,t,i){"use strict";var r=i(1),n=i(10),s=i(3),o=i(0)("species");e.exports=function(e){var t=r[e];s&&t&&!t[o]&&n.f(t,o,{configurable:!0,get:function(){return this}})}},function(e,t,i){"use strict";var r,n,s,o,a=i(19),h=i(1),l=i(13),u=i(22),d=i(8),c=i(7),f=i(20),_=i(35),m=i(94),p=i(36),g=i(56).set,v=i(96)(),y=i(58),E=i(97),S=i(98),b=i(99),w=h.TypeError,A=h.process,R=A&&A.versions,L=R&&R.v8||"",T=h.Promise,I="process"==u(A),k=function(){},x=n=y.f,C=!!function(){try{var e=T.resolve(1),t=(e.constructor={})[i(0)("species")]=function(e){e(k,k)};return(I||"function"==typeof PromiseRejectionEvent)&&e.then(k)instanceof t&&0!==L.indexOf("6.6")&&-1===S.indexOf("Chrome/66")}catch(e){}}(),O=function(e){var t;return!(!c(e)||"function"!=typeof(t=e.then))&&t},D=function(e,t){if(!e._n){e._n=!0;var i=e._c;v((function(){for(var r=e._v,n=1==e._s,s=0,o=function(t){var i,s,o,a=n?t.ok:t.fail,h=t.resolve,l=t.reject,u=t.domain;try{a?(n||(2==e._h&&U(e),e._h=1),!0===a?i=r:(u&&u.enter(),i=a(r),u&&(u.exit(),o=!0)),i===t.promise?l(w("Promise-chain cycle")):(s=O(i))?s.call(i,h,l):h(i)):l(r)}catch(e){u&&!o&&u.exit(),l(e)}};i.length>s;)o(i[s++]);e._c=[],e._n=!1,t&&!e._h&&M(e)}))}},M=function(e){g.call(h,(function(){var t,i,r,n=e._v,s=B(e);if(s&&(t=E((function(){I?A.emit("unhandledRejection",n,e):(i=h.onunhandledrejection)?i({promise:e,reason:n}):(r=h.console)&&r.error&&r.error("Unhandled promise rejection",n)})),e._h=I||B(e)?2:1),e._a=void 0,s&&t.e)throw t.v}))},B=function(e){return 1!==e._h&&0===(e._a||e._c).length},U=function(e){g.call(h,(function(){var t;I?A.emit("rejectionHandled",e):(t=h.onrejectionhandled)&&t({promise:e,reason:e._v})}))},P=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),D(t,!0))},G=function(e){var t,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===e)throw w("Promise can't be resolved itself");(t=O(e))?v((function(){var r={_w:i,_d:!1};try{t.call(e,l(G,r,1),l(P,r,1))}catch(e){P.call(r,e)}})):(i._v=e,i._s=1,D(i,!1))}catch(e){P.call({_w:i,_d:!1},e)}}};C||(T=function(e){_(this,T,"Promise","_h"),f(e),r.call(this);try{e(l(G,this,1),l(P,this,1))}catch(e){P.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(34)(T.prototype,{then:function(e,t){var i=x(p(this,T));return i.ok="function"!=typeof e||e,i.fail="function"==typeof t&&t,i.domain=I?A.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&D(this,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),s=function(){var e=new r;this.promise=e,this.resolve=l(G,e,1),this.reject=l(P,e,1)},y.f=x=function(e){return e===T||e===o?new s(e):n(e)}),d(d.G+d.W+d.F*!C,{Promise:T}),i(27)(T,"Promise"),i(54)("Promise"),o=i(16).Promise,d(d.S+d.F*!C,"Promise",{reject:function(e){var t=x(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(a||!C),"Promise",{resolve:function(e){return b(a&&this===o?T:this,e)}}),d(d.S+d.F*!(C&&i(53)((function(e){T.all(e).catch(k)}))),"Promise",{all:function(e){var t=this,i=x(t),r=i.resolve,n=i.reject,s=E((function(){var i=[],s=0,o=1;m(e,!1,(function(e){var a=s++,h=!1;i.push(void 0),o++,t.resolve(e).then((function(e){h||(h=!0,i[a]=e,--o||r(i))}),n)})),--o||r(i)}));return s.e&&n(s.v),i.promise},race:function(e){var t=this,i=x(t),r=i.reject,n=E((function(){m(e,!1,(function(e){t.resolve(e).then(i.resolve,r)}))}));return n.e&&r(n.v),i.promise}})},function(e,t,i){var r,n,s,o=i(13),a=i(57),h=i(50),l=i(28),u=i(1),d=u.process,c=u.setImmediate,f=u.clearImmediate,_=u.MessageChannel,m=u.Dispatch,p=0,g={},v=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},y=function(e){v.call(e.data)};c&&f||(c=function(e){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return g[++p]=function(){a("function"==typeof e?e:Function(e),t)},r(p),p},f=function(e){delete g[e]},"process"==i(14)(d)?r=function(e){d.nextTick(o(v,e,1))}:m&&m.now?r=function(e){m.now(o(v,e,1))}:_?(s=(n=new _).port2,n.port1.onmessage=y,r=o(s.postMessage,s,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(e){u.postMessage(e+"","*")},u.addEventListener("message",y,!1)):r="onreadystatechange"in l("script")?function(e){h.appendChild(l("script")).onreadystatechange=function(){h.removeChild(this),v.call(e)}}:function(e){setTimeout(o(v,e,1),0)}),e.exports={set:c,clear:f}},function(e,t){e.exports=function(e,t,i){var r=void 0===i;switch(t.length){case 0:return r?e():e.call(i);case 1:return r?e(t[0]):e.call(i,t[0]);case 2:return r?e(t[0],t[1]):e.call(i,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(i,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(i,t[0],t[1],t[2],t[3])}return e.apply(i,t)}},function(e,t,i){"use strict";var r=i(20);function n(e){var t,i;this.promise=new e((function(e,r){if(void 0!==t||void 0!==i)throw TypeError("Bad Promise constructor");t=e,i=r})),this.resolve=r(t),this.reject=r(i)}e.exports.f=function(e){return new n(e)}},function(e,t,i){"use strict";var r=i(22),n={};n[i(0)("toStringTag")]="z",n+""!="[object z]"&&i(17)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,i){var r=function(e){"use strict";var t=Object.prototype,i=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function a(e,t,i,r){var n=t&&t.prototype instanceof u?t:u,s=Object.create(n.prototype),o=new b(r||[]);return s._invoke=function(e,t,i){var r="suspendedStart";return function(n,s){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw s;return A()}for(i.method=n,i.arg=s;;){var o=i.delegate;if(o){var a=y(o,i);if(a){if(a===l)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var u=h(e,t,i);if("normal"===u.type){if(r=i.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r="completed",i.method="throw",i.arg=u.arg)}}}(e,i,o),s}function h(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=a;var l={};function u(){}function d(){}function c(){}var f={};f[n]=function(){return this};var _=Object.getPrototypeOf,m=_&&_(_(w([])));m&&m!==t&&i.call(m,n)&&(f=m);var p=c.prototype=u.prototype=Object.create(f);function g(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function v(e,t){var r;this._invoke=function(n,s){function o(){return new t((function(r,o){!function r(n,s,o,a){var l=h(e[n],e,s);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,o,a)}),(function(e){r("throw",e,o,a)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,a)}))}a(l.arg)}(n,s,r,o)}))}return r=r?r.then(o,o):o()}}function y(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,y(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=h(i,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var n=r.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function b(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function w(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return s.next=s}}return{next:A}}function A(){return{value:void 0,done:!0}}return d.prototype=p.constructor=c,c.constructor=d,c[o]=d.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(p),e},e.awrap=function(e){return{__await:e}},g(v.prototype),v.prototype[s]=function(){return this},e.AsyncIterator=v,e.async=function(t,i,r,n,s){void 0===s&&(s=Promise);var o=new v(a(t,i,r,n),s);return e.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},g(p),p[o]="Generator",p[n]=function(){return this},p.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}},e.values=w,b.prototype={constructor:b,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(i,r){return o.type="throw",o.arg=e,t.next=i,r&&(t.method="next",t.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var a=i.call(s,"catchLoc"),h=i.call(s,"finallyLoc");if(a&&h){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,l):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),S(i),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;S(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:w(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,i){var r=i(8);r(r.S+r.F,"Object",{assign:i(63)})},function(e,t,i){e.exports=i(30)("native-function-to-string",Function.toString)},function(e,t,i){"use strict";var r=i(3),n=i(39),s=i(64),o=i(42),a=i(15),h=i(31),l=Object.assign;e.exports=!l||i(9)((function(){var e={},t={},i=Symbol(),r="abcdefghijklmnopqrst";return e[i]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[i]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var i=a(e),l=arguments.length,u=1,d=s.f,c=o.f;l>u;)for(var f,_=h(arguments[u++]),m=d?n(_).concat(d(_)):n(_),p=m.length,g=0;p>g;)f=m[g++],r&&!c.call(_,f)||(i[f]=_[f]);return i}:l},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,i){i(66)("Uint8",1,(function(e){return function(t,i,r){return e(this,t,i,r)}}))},function(e,t,i){"use strict";if(i(3)){var r=i(19),n=i(1),s=i(9),o=i(8),a=i(44),h=i(67),l=i(13),u=i(35),d=i(24),c=i(5),f=i(34),_=i(11),m=i(4),p=i(45),g=i(26),v=i(29),y=i(12),E=i(22),S=i(7),b=i(15),w=i(48),A=i(49),R=i(51),L=i(46).f,T=i(52),I=i(18),k=i(0),x=i(69),C=i(41),O=i(36),D=i(73),M=i(23),B=i(53),U=i(54),P=i(47),G=i(78),N=i(10),F=i(79),V=N.f,j=F.f,W=n.RangeError,z=n.TypeError,H=n.Uint8Array,K=Array.prototype,q=h.ArrayBuffer,$=h.DataView,Y=x(0),X=x(2),Z=x(3),J=x(4),Q=x(5),ee=x(6),te=C(!0),ie=C(!1),re=D.values,ne=D.keys,se=D.entries,oe=K.lastIndexOf,ae=K.reduce,he=K.reduceRight,le=K.join,ue=K.sort,de=K.slice,ce=K.toString,fe=K.toLocaleString,_e=k("iterator"),me=k("toStringTag"),pe=I("typed_constructor"),ge=I("def_constructor"),ve=a.CONSTR,ye=a.TYPED,Ee=a.VIEW,Se=x(1,(function(e,t){return Le(O(e,e[ge]),t)})),be=s((function(){return 1===new H(new Uint16Array([1]).buffer)[0]})),we=!!H&&!!H.prototype.set&&s((function(){new H(1).set({})})),Ae=function(e,t){var i=_(e);if(i<0||i%t)throw W("Wrong offset!");return i},Re=function(e){if(S(e)&&ye in e)return e;throw z(e+" is not a typed array!")},Le=function(e,t){if(!S(e)||!(pe in e))throw z("It is not a typed array constructor!");return new e(t)},Te=function(e,t){return Ie(O(e,e[ge]),t)},Ie=function(e,t){for(var i=0,r=t.length,n=Le(e,r);r>i;)n[i]=t[i++];return n},ke=function(e,t,i){V(e,t,{get:function(){return this._d[i]}})},xe=function(e){var t,i,r,n,s,o,a=b(e),h=arguments.length,u=h>1?arguments[1]:void 0,d=void 0!==u,c=T(a);if(null!=c&&!w(c)){for(o=c.call(a),r=[],t=0;!(s=o.next()).done;t++)r.push(s.value);a=r}for(d&&h>2&&(u=l(u,arguments[2],2)),t=0,i=m(a.length),n=Le(this,i);i>t;t++)n[t]=d?u(a[t],t):a[t];return n},Ce=function(){for(var e=0,t=arguments.length,i=Le(this,t);t>e;)i[e]=arguments[e++];return i},Oe=!!H&&s((function(){fe.call(new H(1))})),De=function(){return fe.apply(Oe?de.call(Re(this)):Re(this),arguments)},Me={copyWithin:function(e,t){return G.call(Re(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return J(Re(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return P.apply(Re(this),arguments)},filter:function(e){return Te(this,X(Re(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return Q(Re(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Re(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Y(Re(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ie(Re(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Re(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return le.apply(Re(this),arguments)},lastIndexOf:function(e){return oe.apply(Re(this),arguments)},map:function(e){return Se(Re(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return ae.apply(Re(this),arguments)},reduceRight:function(e){return he.apply(Re(this),arguments)},reverse:function(){for(var e,t=Re(this).length,i=Math.floor(t/2),r=0;r<i;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return Z(Re(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ue.call(Re(this),e)},subarray:function(e,t){var i=Re(this),r=i.length,n=g(e,r);return new(O(i,i[ge]))(i.buffer,i.byteOffset+n*i.BYTES_PER_ELEMENT,m((void 0===t?r:g(t,r))-n))}},Be=function(e,t){return Te(this,de.call(Re(this),e,t))},Ue=function(e){Re(this);var t=Ae(arguments[1],1),i=this.length,r=b(e),n=m(r.length),s=0;if(n+t>i)throw W("Wrong length!");for(;s<n;)this[t+s]=r[s++]},Pe={entries:function(){return se.call(Re(this))},keys:function(){return ne.call(Re(this))},values:function(){return re.call(Re(this))}},Ge=function(e,t){return S(e)&&e[ye]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Ne=function(e,t){return Ge(e,t=v(t,!0))?d(2,e[t]):j(e,t)},Fe=function(e,t,i){return!(Ge(e,t=v(t,!0))&&S(i)&&y(i,"value"))||y(i,"get")||y(i,"set")||i.configurable||y(i,"writable")&&!i.writable||y(i,"enumerable")&&!i.enumerable?V(e,t,i):(e[t]=i.value,e)};ve||(F.f=Ne,N.f=Fe),o(o.S+o.F*!ve,"Object",{getOwnPropertyDescriptor:Ne,defineProperty:Fe}),s((function(){ce.call({})}))&&(ce=fe=function(){return le.call(this)});var Ve=f({},Me);f(Ve,Pe),c(Ve,_e,Pe.values),f(Ve,{slice:Be,set:Ue,constructor:function(){},toString:ce,toLocaleString:De}),ke(Ve,"buffer","b"),ke(Ve,"byteOffset","o"),ke(Ve,"byteLength","l"),ke(Ve,"length","e"),V(Ve,me,{get:function(){return this[ye]}}),e.exports=function(e,t,i,h){var l=e+((h=!!h)?"Clamped":"")+"Array",d="get"+e,f="set"+e,_=n[l],g=_||{},v=_&&R(_),y=!_||!a.ABV,b={},w=_&&_.prototype,T=function(e,i){V(e,i,{get:function(){return function(e,i){var r=e._d;return r.v[d](i*t+r.o,be)}(this,i)},set:function(e){return function(e,i,r){var n=e._d;h&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),n.v[f](i*t+n.o,r,be)}(this,i,e)},enumerable:!0})};y?(_=i((function(e,i,r,n){u(e,_,l,"_d");var s,o,a,h,d=0,f=0;if(S(i)){if(!(i instanceof q||"ArrayBuffer"==(h=E(i))||"SharedArrayBuffer"==h))return ye in i?Ie(_,i):xe.call(_,i);s=i,f=Ae(r,t);var g=i.byteLength;if(void 0===n){if(g%t)throw W("Wrong length!");if((o=g-f)<0)throw W("Wrong length!")}else if((o=m(n)*t)+f>g)throw W("Wrong length!");a=o/t}else a=p(i),s=new q(o=a*t);for(c(e,"_d",{b:s,o:f,l:o,e:a,v:new $(s)});d<a;)T(e,d++)})),w=_.prototype=A(Ve),c(w,"constructor",_)):s((function(){_(1)}))&&s((function(){new _(-1)}))&&B((function(e){new _,new _(null),new _(1.5),new _(e)}),!0)||(_=i((function(e,i,r,n){var s;return u(e,_,l),S(i)?i instanceof q||"ArrayBuffer"==(s=E(i))||"SharedArrayBuffer"==s?void 0!==n?new g(i,Ae(r,t),n):void 0!==r?new g(i,Ae(r,t)):new g(i):ye in i?Ie(_,i):xe.call(_,i):new g(p(i))})),Y(v!==Function.prototype?L(g).concat(L(v)):L(g),(function(e){e in _||c(_,e,g[e])})),_.prototype=w,r||(w.constructor=_));var I=w[_e],k=!!I&&("values"==I.name||null==I.name),x=Pe.values;c(_,pe,!0),c(w,ye,l),c(w,Ee,!0),c(w,ge,_),(h?new _(1)[me]==l:me in w)||V(w,me,{get:function(){return l}}),b[l]=_,o(o.G+o.W+o.F*(_!=g),b),o(o.S,l,{BYTES_PER_ELEMENT:t}),o(o.S+o.F*s((function(){g.of.call(_,1)})),l,{from:xe,of:Ce}),"BYTES_PER_ELEMENT"in w||c(w,"BYTES_PER_ELEMENT",t),o(o.P,l,Me),U(l),o(o.P+o.F*we,l,{set:Ue}),o(o.P+o.F*!k,l,Pe),r||w.toString==ce||(w.toString=ce),o(o.P+o.F*s((function(){new _(1).slice()})),l,{slice:Be}),o(o.P+o.F*(s((function(){return[1,2].toLocaleString()!=new _([1,2]).toLocaleString()}))||!s((function(){w.toLocaleString.call([1,2])}))),l,{toLocaleString:De}),M[l]=k?I:x,r||k||c(w,_e,x)}}else e.exports=function(){}},function(e,t,i){"use strict";var r=i(1),n=i(3),s=i(19),o=i(44),a=i(5),h=i(34),l=i(9),u=i(35),d=i(11),c=i(4),f=i(45),_=i(46).f,m=i(10).f,p=i(47),g=i(27),v=r.ArrayBuffer,y=r.DataView,E=r.Math,S=r.RangeError,b=r.Infinity,w=v,A=E.abs,R=E.pow,L=E.floor,T=E.log,I=E.LN2,k=n?"_b":"buffer",x=n?"_l":"byteLength",C=n?"_o":"byteOffset";function O(e,t,i){var r,n,s,o=new Array(i),a=8*i-t-1,h=(1<<a)-1,l=h>>1,u=23===t?R(2,-24)-R(2,-77):0,d=0,c=e<0||0===e&&1/e<0?1:0;for((e=A(e))!=e||e===b?(n=e!=e?1:0,r=h):(r=L(T(e)/I),e*(s=R(2,-r))<1&&(r--,s*=2),(e+=r+l>=1?u/s:u*R(2,1-l))*s>=2&&(r++,s/=2),r+l>=h?(n=0,r=h):r+l>=1?(n=(e*s-1)*R(2,t),r+=l):(n=e*R(2,l-1)*R(2,t),r=0));t>=8;o[d++]=255&n,n/=256,t-=8);for(r=r<<t|n,a+=t;a>0;o[d++]=255&r,r/=256,a-=8);return o[--d]|=128*c,o}function D(e,t,i){var r,n=8*i-t-1,s=(1<<n)-1,o=s>>1,a=n-7,h=i-1,l=e[h--],u=127&l;for(l>>=7;a>0;u=256*u+e[h],h--,a-=8);for(r=u&(1<<-a)-1,u>>=-a,a+=t;a>0;r=256*r+e[h],h--,a-=8);if(0===u)u=1-o;else{if(u===s)return r?NaN:l?-b:b;r+=R(2,t),u-=o}return(l?-1:1)*r*R(2,u-t)}function M(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function B(e){return[255&e]}function U(e){return[255&e,e>>8&255]}function P(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function G(e){return O(e,52,8)}function N(e){return O(e,23,4)}function F(e,t,i){m(e.prototype,t,{get:function(){return this[i]}})}function V(e,t,i,r){var n=f(+i);if(n+t>e[x])throw S("Wrong index!");var s=e[k]._b,o=n+e[C],a=s.slice(o,o+t);return r?a:a.reverse()}function j(e,t,i,r,n,s){var o=f(+i);if(o+t>e[x])throw S("Wrong index!");for(var a=e[k]._b,h=o+e[C],l=r(+n),u=0;u<t;u++)a[h+u]=l[s?u:t-u-1]}if(o.ABV){if(!l((function(){v(1)}))||!l((function(){new v(-1)}))||l((function(){return new v,new v(1.5),new v(NaN),"ArrayBuffer"!=v.name}))){for(var W,z=(v=function(e){return u(this,v),new w(f(e))}).prototype=w.prototype,H=_(w),K=0;H.length>K;)(W=H[K++])in v||a(v,W,w[W]);s||(z.constructor=v)}var q=new y(new v(2)),$=y.prototype.setInt8;q.setInt8(0,2147483648),q.setInt8(1,2147483649),!q.getInt8(0)&&q.getInt8(1)||h(y.prototype,{setInt8:function(e,t){$.call(this,e,t<<24>>24)},setUint8:function(e,t){$.call(this,e,t<<24>>24)}},!0)}else v=function(e){u(this,v,"ArrayBuffer");var t=f(e);this._b=p.call(new Array(t),0),this[x]=t},y=function(e,t,i){u(this,y,"DataView"),u(e,v,"DataView");var r=e[x],n=d(t);if(n<0||n>r)throw S("Wrong offset!");if(n+(i=void 0===i?r-n:c(i))>r)throw S("Wrong length!");this[k]=e,this[C]=n,this[x]=i},n&&(F(v,"byteLength","_l"),F(y,"buffer","_b"),F(y,"byteLength","_l"),F(y,"byteOffset","_o")),h(y.prototype,{getInt8:function(e){return V(this,1,e)[0]<<24>>24},getUint8:function(e){return V(this,1,e)[0]},getInt16:function(e){var t=V(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=V(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return M(V(this,4,e,arguments[1]))},getUint32:function(e){return M(V(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return D(V(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return D(V(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){j(this,1,e,B,t)},setUint8:function(e,t){j(this,1,e,B,t)},setInt16:function(e,t){j(this,2,e,U,t,arguments[2])},setUint16:function(e,t){j(this,2,e,U,t,arguments[2])},setInt32:function(e,t){j(this,4,e,P,t,arguments[2])},setUint32:function(e,t){j(this,4,e,P,t,arguments[2])},setFloat32:function(e,t){j(this,4,e,N,t,arguments[2])},setFloat64:function(e,t){j(this,8,e,G,t,arguments[2])}});g(v,"ArrayBuffer"),g(y,"DataView"),a(y.prototype,o.VIEW,!0),t.ArrayBuffer=v,t.DataView=y},function(e,t,i){var r=i(10),n=i(6),s=i(39);e.exports=i(3)?Object.defineProperties:function(e,t){n(e);for(var i,o=s(t),a=o.length,h=0;a>h;)r.f(e,i=o[h++],t[i]);return e}},function(e,t,i){var r=i(13),n=i(31),s=i(15),o=i(4),a=i(70);e.exports=function(e,t){var i=1==e,h=2==e,l=3==e,u=4==e,d=6==e,c=5==e||d,f=t||a;return function(t,a,_){for(var m,p,g=s(t),v=n(g),y=r(a,_,3),E=o(v.length),S=0,b=i?f(t,E):h?f(t,0):void 0;E>S;S++)if((c||S in v)&&(p=y(m=v[S],S,g),e))if(i)b[S]=p;else if(p)switch(e){case 3:return!0;case 5:return m;case 6:return S;case 2:b.push(m)}else if(u)return!1;return d?-1:l||u?u:b}}},function(e,t,i){var r=i(71);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,i){var r=i(7),n=i(72),s=i(0)("species");e.exports=function(e){var t;return n(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!n(t.prototype)||(t=void 0),r(t)&&null===(t=t[s])&&(t=void 0)),void 0===t?Array:t}},function(e,t,i){var r=i(14);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,i){"use strict";var r=i(74),n=i(75),s=i(23),o=i(21);e.exports=i(76)(Array,"Array",(function(e,t){this._t=o(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,i=this._i++;return!e||i>=e.length?(this._t=void 0,n(1)):n(0,"keys"==t?i:"values"==t?e[i]:[i,e[i]])}),"values"),s.Arguments=s.Array,r("keys"),r("values"),r("entries")},function(e,t,i){var r=i(0)("unscopables"),n=Array.prototype;null==n[r]&&i(5)(n,r,{}),e.exports=function(e){n[r][e]=!0}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,i){"use strict";var r=i(19),n=i(8),s=i(17),o=i(5),a=i(23),h=i(77),l=i(27),u=i(51),d=i(0)("iterator"),c=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,i,_,m,p,g){h(i,t,_);var v,y,E,S=function(e){if(!c&&e in R)return R[e];switch(e){case"keys":case"values":return function(){return new i(this,e)}}return function(){return new i(this,e)}},b=t+" Iterator",w="values"==m,A=!1,R=e.prototype,L=R[d]||R["@@iterator"]||m&&R[m],T=L||S(m),I=m?w?S("entries"):T:void 0,k="Array"==t&&R.entries||L;if(k&&(E=u(k.call(new e)))!==Object.prototype&&E.next&&(l(E,b,!0),r||"function"==typeof E[d]||o(E,d,f)),w&&L&&"values"!==L.name&&(A=!0,T=function(){return L.call(this)}),r&&!g||!c&&!A&&R[d]||o(R,d,T),a[t]=T,a[b]=f,m)if(v={values:w?T:S("values"),keys:p?T:S("keys"),entries:I},g)for(y in v)y in R||s(R,y,v[y]);else n(n.P+n.F*(c||A),t,v);return v}},function(e,t,i){"use strict";var r=i(49),n=i(24),s=i(27),o={};i(5)(o,i(0)("iterator"),(function(){return this})),e.exports=function(e,t,i){e.prototype=r(o,{next:n(1,i)}),s(e,t+" Iterator")}},function(e,t,i){"use strict";var r=i(15),n=i(26),s=i(4);e.exports=[].copyWithin||function(e,t){var i=r(this),o=s(i.length),a=n(e,o),h=n(t,o),l=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===l?o:n(l,o))-h,o-a),d=1;for(h<a&&a<h+u&&(d=-1,h+=u-1,a+=u-1);u-- >0;)h in i?i[a]=i[h]:delete i[a],a+=d,h+=d;return i}},function(e,t,i){var r=i(42),n=i(24),s=i(21),o=i(29),a=i(12),h=i(38),l=Object.getOwnPropertyDescriptor;t.f=i(3)?l:function(e,t){if(e=s(e),t=o(t,!0),h)try{return l(e,t)}catch(e){}if(a(e,t))return n(!r.f.call(e,t),e[t])}},function(e,t,i){"use strict";var r=i(81),n=i(6),s=i(36),o=i(82),a=i(4),h=i(84),l=i(37),u=i(9),d=Math.min,c=[].push,f="length",_=!u((function(){RegExp(4294967295,"y")}));i(86)("split",2,(function(e,t,i,u){var m;return m="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[f]||2!="ab".split(/(?:ab)*/)[f]||4!=".".split(/(.?)(.?)/)[f]||".".split(/()()/)[f]>1||"".split(/.?/)[f]?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!r(e))return i.call(n,e,t);for(var s,o,a,h=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,_=void 0===t?4294967295:t>>>0,m=new RegExp(e.source,u+"g");(s=l.call(m,n))&&!((o=m.lastIndex)>d&&(h.push(n.slice(d,s.index)),s[f]>1&&s.index<n[f]&&c.apply(h,s.slice(1)),a=s[0][f],d=o,h[f]>=_));)m.lastIndex===s.index&&m.lastIndex++;return d===n[f]?!a&&m.test("")||h.push(""):h.push(n.slice(d)),h[f]>_?h.slice(0,_):h}:"0".split(void 0,0)[f]?function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)}:i,[function(i,r){var n=e(this),s=null==i?void 0:i[t];return void 0!==s?s.call(i,n,r):m.call(String(n),i,r)},function(e,t){var r=u(m,e,this,t,m!==i);if(r.done)return r.value;var l=n(e),c=String(this),f=s(l,RegExp),p=l.unicode,g=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(_?"y":"g"),v=new f(_?l:"^(?:"+l.source+")",g),y=void 0===t?4294967295:t>>>0;if(0===y)return[];if(0===c.length)return null===h(v,c)?[c]:[];for(var E=0,S=0,b=[];S<c.length;){v.lastIndex=_?S:0;var w,A=h(v,_?c:c.slice(S));if(null===A||(w=d(a(v.lastIndex+(_?0:S)),c.length))===E)S=o(c,S,p);else{if(b.push(c.slice(E,S)),b.length===y)return b;for(var R=1;R<=A.length-1;R++)if(b.push(A[R]),b.length===y)return b;S=E=w}}return b.push(c.slice(E)),b}]}))},function(e,t,i){var r=i(7),n=i(14),s=i(0)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==n(e))}},function(e,t,i){"use strict";var r=i(83)(!0);e.exports=function(e,t,i){return t+(i?r(e,t).length:1)}},function(e,t,i){var r=i(11),n=i(25);e.exports=function(e){return function(t,i){var s,o,a=String(n(t)),h=r(i),l=a.length;return h<0||h>=l?e?"":void 0:(s=a.charCodeAt(h))<55296||s>56319||h+1===l||(o=a.charCodeAt(h+1))<56320||o>57343?e?a.charAt(h):s:e?a.slice(h,h+2):o-56320+(s-55296<<10)+65536}}},function(e,t,i){"use strict";var r=i(22),n=RegExp.prototype.exec;e.exports=function(e,t){var i=e.exec;if("function"==typeof i){var s=i.call(e,t);if("object"!=typeof s)throw new TypeError("RegExp exec method returned something other than an Object or null");return s}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return n.call(e,t)}},function(e,t,i){"use strict";var r=i(6);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,i){"use strict";i(87);var r=i(17),n=i(5),s=i(9),o=i(25),a=i(0),h=i(37),l=a("species"),u=!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();e.exports=function(e,t,i){var c=a(e),f=!s((function(){var t={};return t[c]=function(){return 7},7!=""[e](t)})),_=f?!s((function(){var t=!1,i=/a/;return i.exec=function(){return t=!0,null},"split"===e&&(i.constructor={},i.constructor[l]=function(){return i}),i[c](""),!t})):void 0;if(!f||!_||"replace"===e&&!u||"split"===e&&!d){var m=/./[c],p=i(o,c,""[e],(function(e,t,i,r,n){return t.exec===h?f&&!n?{done:!0,value:m.call(t,i,r)}:{done:!0,value:e.call(i,t,r)}:{done:!1}})),g=p[0],v=p[1];r(String.prototype,e,g),n(RegExp.prototype,c,2==t?function(e,t){return v.call(e,this,t)}:function(e){return v.call(e,this)})}}},function(e,t,i){"use strict";var r=i(37);i(8)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,i){"use strict";var r=i(8),n=i(21),s=i(11),o=i(4),a=[].lastIndexOf,h=!!a&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(h||!i(89)(a)),"Array",{lastIndexOf:function(e){if(h)return a.apply(this,arguments)||0;var t=n(this),i=o(t.length),r=i-1;for(arguments.length>1&&(r=Math.min(r,s(arguments[1]))),r<0&&(r=i+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,i){"use strict";var r=i(9);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,i){(function(t,i){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var r;r=function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,s=void 0,o=void 0,a=function(e,t){_[n]=e,_[n+1]=t,2===(n+=2)&&(o?o(m):E())},h="undefined"!=typeof window?window:void 0,l=h||{},u=l.MutationObserver||l.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(m,1)}}var _=new Array(1e3);function m(){for(var e=0;e<n;e+=2)(0,_[e])(_[e+1]),_[e]=void 0,_[e+1]=void 0;n=0}var p,g,v,y,E=void 0;function S(e,t){var i=this,r=new this.constructor(A);void 0===r[w]&&M(r);var n=i._state;if(n){var s=arguments[n-1];a((function(){return O(n,r,s,i._result)}))}else x(i,r,e,t);return r}function b(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(A);return L(t,e),t}d?E=function(){return t.nextTick(m)}:u?(g=0,v=new u(m),y=document.createTextNode(""),v.observe(y,{characterData:!0}),E=function(){y.data=g=++g%2}):c?((p=new MessageChannel).port1.onmessage=m,E=function(){return p.port2.postMessage(0)}):E=void 0===h?function(){try{var e=Function("return this")().require("vertx");return void 0!==(s=e.runOnLoop||e.runOnContext)?function(){s(m)}:f()}catch(e){return f()}}():f();var w=Math.random().toString(36).substring(2);function A(){}function R(t,i,r){i.constructor===t.constructor&&r===S&&i.constructor.resolve===b?function(e,t){1===t._state?I(e,t._result):2===t._state?k(e,t._result):x(t,void 0,(function(t){return L(e,t)}),(function(t){return k(e,t)}))}(t,i):void 0===r?I(t,i):e(r)?function(e,t,i){a((function(e){var r=!1,n=function(e,t,i,r){try{e.call(t,i,r)}catch(e){return e}}(i,t,(function(i){r||(r=!0,t!==i?L(e,i):I(e,i))}),(function(t){r||(r=!0,k(e,t))}),e._label);!r&&n&&(r=!0,k(e,n))}),e)}(t,i,r):I(t,i)}function L(e,t){if(e===t)k(e,new TypeError("You cannot resolve a promise with itself"));else if(n=typeof(r=t),null===r||"object"!==n&&"function"!==n)I(e,t);else{var i=void 0;try{i=t.then}catch(t){return void k(e,t)}R(e,t,i)}var r,n}function T(e){e._onerror&&e._onerror(e._result),C(e)}function I(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&a(C,e))}function k(e,t){void 0===e._state&&(e._state=2,e._result=t,a(T,e))}function x(e,t,i,r){var n=e._subscribers,s=n.length;e._onerror=null,n[s]=t,n[s+1]=i,n[s+2]=r,0===s&&e._state&&a(C,e)}function C(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var r=void 0,n=void 0,s=e._result,o=0;o<t.length;o+=3)r=t[o],n=t[o+i],r?O(i,r,n,s):n(s);e._subscribers.length=0}}function O(t,i,r,n){var s=e(r),o=void 0,a=void 0,h=!0;if(s){try{o=r(n)}catch(e){h=!1,a=e}if(i===o)return void k(i,new TypeError("A promises callback cannot return that same promise."))}else o=n;void 0!==i._state||(s&&h?L(i,o):!1===h?k(i,a):1===t?I(i,o):2===t&&k(i,o))}var D=0;function M(e){e[w]=D++,e._state=void 0,e._result=void 0,e._subscribers=[]}var B=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(A),this.promise[w]||M(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?I(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&I(this.promise,this._result))):k(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var i=this._instanceConstructor,r=i.resolve;if(r===b){var n=void 0,s=void 0,o=!1;try{n=e.then}catch(e){o=!0,s=e}if(n===S&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof n)this._remaining--,this._result[t]=e;else if(i===U){var a=new i(A);o?k(a,s):R(a,e,n),this._willSettleAt(a,t)}else this._willSettleAt(new i((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,i){var r=this.promise;void 0===r._state&&(this._remaining--,2===e?k(r,i):this._result[t]=i),0===this._remaining&&I(r,this._result)},e.prototype._willSettleAt=function(e,t){var i=this;x(e,void 0,(function(e){return i._settledAt(1,t,e)}),(function(e){return i._settledAt(2,t,e)}))},e}(),U=function(){function t(e){this[w]=D++,this._result=this._state=void 0,this._subscribers=[],A!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){L(e,t)}),(function(t){k(e,t)}))}catch(t){k(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var i=this.constructor;return e(t)?this.then((function(e){return i.resolve(t()).then((function(){return e}))}),(function(e){return i.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return U.prototype.then=S,U.all=function(e){return new B(this,e).promise},U.race=function(e){var t=this;return r(e)?new t((function(i,r){for(var n=e.length,s=0;s<n;s++)t.resolve(e[s]).then(i,r)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},U.resolve=b,U.reject=function(e){var t=new this(A);return k(t,e),t},U._setScheduler=function(e){o=e},U._setAsap=function(e){a=e},U._asap=a,U.polyfill=function(){var e=void 0;if(void 0!==i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=U},U.Promise=U,U},e.exports=r()}).call(this,i(91),i(92))},function(e,t){var i,r,n=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(e){i=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var h,l=[],u=!1,d=-1;function c(){u&&h&&(u=!1,h.length?l=h.concat(l):d=-1,l.length&&f())}function f(){if(!u){var e=a(c);u=!0;for(var t=l.length;t;){for(h=l,l=[];++d<t;)h&&h[d].run();d=-1,t=l.length}h=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];l.push(new _(e,t)),1!==l.length||u||a(f)},_.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t){var i=arguments[3],r=arguments[4],n=arguments[5],s=JSON.stringify;e.exports=function(e,t){for(var o,a=Object.keys(n),h=0,l=a.length;h<l;h++){var u=a[h],d=n[u].exports;if(d===e||d&&d.default===e){o=u;break}}if(!o){o=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var c={};for(h=0,l=a.length;h<l;h++){c[u=a[h]]=u}r[o]=["function(require,module,exports){"+e+"(self); }",c]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),_={};_[o]=o,r[f]=["function(require,module,exports){var f = require("+s(o)+");(f.default ? f.default : f)(self);}",_];var m={};!function e(t){for(var i in m[t]=!0,r[t][1]){var n=r[t][1][i];m[n]||e(n)}}(f);var p="("+i+")({"+Object.keys(m).map((function(e){return s(e)+":["+r[e][0]+","+s(r[e][1])+"]"})).join(",")+"},{},["+s(f)+"])",g=window.URL||window.webkitURL||window.mozURL||window.msURL,v=new Blob([p],{type:"text/javascript"});if(t&&t.bare)return v;var y=g.createObjectURL(v),E=new Worker(y);return E.objectURL=y,E}},function(e,t,i){var r=i(13),n=i(95),s=i(48),o=i(6),a=i(4),h=i(52),l={},u={};(t=e.exports=function(e,t,i,d,c){var f,_,m,p,g=c?function(){return e}:h(e),v=r(i,d,t?2:1),y=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(s(g)){for(f=a(e.length);f>y;y++)if((p=t?v(o(_=e[y])[0],_[1]):v(e[y]))===l||p===u)return p}else for(m=g.call(e);!(_=m.next()).done;)if((p=n(m,v,_.value,t))===l||p===u)return p}).BREAK=l,t.RETURN=u},function(e,t,i){var r=i(6);e.exports=function(e,t,i,n){try{return n?t(r(i)[0],i[1]):t(i)}catch(t){var s=e.return;throw void 0!==s&&r(s.call(e)),t}}},function(e,t,i){var r=i(1),n=i(56).set,s=r.MutationObserver||r.WebKitMutationObserver,o=r.process,a=r.Promise,h="process"==i(14)(o);e.exports=function(){var e,t,i,l=function(){var r,n;for(h&&(r=o.domain)&&r.exit();e;){n=e.fn,e=e.next;try{n()}catch(r){throw e?i():t=void 0,r}}t=void 0,r&&r.enter()};if(h)i=function(){o.nextTick(l)};else if(!s||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var u=a.resolve(void 0);i=function(){u.then(l)}}else i=function(){n.call(r,l)};else{var d=!0,c=document.createTextNode("");new s(l).observe(c,{characterData:!0}),i=function(){c.data=d=!d}}return function(r){var n={fn:r,next:void 0};t&&(t.next=n),e||(e=n,i()),t=n}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,i){var r=i(1).navigator;e.exports=r&&r.userAgent||""},function(e,t,i){var r=i(6),n=i(7),s=i(58);e.exports=function(e,t){if(r(e),n(t)&&t.constructor===e)return t;var i=s.f(e);return(0,i.resolve)(t),i.promise}},function(e,t,i){var r=i(8);r(r.P,"Function",{bind:i(101)})},function(e,t,i){"use strict";var r=i(20),n=i(7),s=i(57),o=[].slice,a={},h=function(e,t,i){if(!(t in a)){for(var r=[],n=0;n<t;n++)r[n]="a["+n+"]";a[t]=Function("F,a","return new F("+r.join(",")+")")}return a[t](e,i)};e.exports=Function.bind||function(e){var t=r(this),i=o.call(arguments,1),a=function(){var r=i.concat(o.call(arguments));return this instanceof a?h(t,r.length,r):s(t,r,e)};return n(t.prototype)&&(a.prototype=t.prototype),a}},function(e,t,i){"use strict";i.r(t);i(61),i(43),i(65),i(80),i(88);var r=function(e){var t=e.lastIndexOf(".");return"flv"===e.substring(t+1)||(console.error("格式不支持"),!1)},n=function(e){for(var t=e.split(";base64,"),i=t[0].split(":")[1],r=window.atob(t[1]),n=r.length,s=new Uint8Array(n),o=0;o<n;++o)s[o]=r.charCodeAt(o);return new Blob([s],{type:i})},s=function(e){var t=new Date(1e3*e),i=t.getHours(),r=t.getMinutes(),n=t.getSeconds();return i<10&&(i="0"+i),r<10&&(r="0"+r),n<10&&(n="0"+n),i+":"+r+":"+n},o=function(e,t,i){var r=new Date(1e3*e),n=new Date(1e3*t),s=r.getHours(),o=r.getMinutes(),a=r.getSeconds(),h=n.getHours(),l=n.getMinutes(),u=n.getSeconds();return s===h?o===l?a===u?1:i/(u-a):i/(60*l+u-60*o-a):i/(3600*h+60*l+u-3600*s-60*o-a)};class a{static install(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");let t=Object(e);for(let e=1;e<arguments.length;e++){let i=arguments[e];if(null!=i)for(let e in i)i.hasOwnProperty(e)&&(t[e]=i[e])}return t},"function"!=typeof self.Promise&&i(90).polyfill()}}a.install();var h=a,l=i(2),u=i.n(l);class d{static e(e,t){e&&!d.FORCE_GLOBAL_TAG||(e=d.GLOBAL_TAG);let i=`[${e}] > ${t}`;d.ENABLE_CALLBACK&&d.emitter.emit("log","error",i),d.ENABLE_ERROR&&(console.error?console.error(i):console.warn?console.warn(i):console.log(i))}static i(e,t){e&&!d.FORCE_GLOBAL_TAG||(e=d.GLOBAL_TAG);let i=`[${e}] > ${t}`;d.ENABLE_CALLBACK&&d.emitter.emit("log","info",i),d.ENABLE_INFO&&(console.info?console.info(i):console.log(i))}static w(e,t){e&&!d.FORCE_GLOBAL_TAG||(e=d.GLOBAL_TAG);let i=`[${e}] > ${t}`;d.ENABLE_CALLBACK&&d.emitter.emit("log","warn",i),d.ENABLE_WARN&&(console.warn?console.warn(i):console.log(i))}static d(e,t){e&&!d.FORCE_GLOBAL_TAG||(e=d.GLOBAL_TAG);let i=`[${e}] > ${t}`;d.ENABLE_CALLBACK&&d.emitter.emit("log","debug",i),d.ENABLE_DEBUG&&(console.debug?console.debug(i):console.log(i))}static v(e,t){e&&!d.FORCE_GLOBAL_TAG||(e=d.GLOBAL_TAG);let i=`[${e}] > ${t}`;d.ENABLE_CALLBACK&&d.emitter.emit("log","verbose",i),d.ENABLE_VERBOSE&&console.log(i)}}d.GLOBAL_TAG="flv.js",d.FORCE_GLOBAL_TAG=!1,d.ENABLE_ERROR=!0,d.ENABLE_INFO=!0,d.ENABLE_WARN=!0,d.ENABLE_DEBUG=!0,d.ENABLE_VERBOSE=!0,d.ENABLE_CALLBACK=!1,d.emitter=new u.a;var c=d;var f=class{constructor(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}reset(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0}addBytes(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())}get currentKBps(){this.addBytes(0);let e=(this._now()-this._lastCheckpoint)/1e3;return 0==e&&(e=1),this._intervalBytes/e/1024}get lastSecondKBps(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}get averageKBps(){let e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024}};class _{constructor(e){this._message=e}get name(){return"RuntimeException"}get message(){return this._message}toString(){return this.name+": "+this.message}}class m extends _{constructor(e){super(e)}get name(){return"IllegalStateException"}}class p extends _{constructor(e){super(e)}get name(){return"InvalidArgumentException"}}class g extends _{constructor(e){super(e)}get name(){return"NotImplementedException"}}const v={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},y={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"};class E{constructor(e){this._type=e||"undefined",this._status=v.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}destroy(){this._status=v.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}isWorking(){return this._status===v.kConnecting||this._status===v.kBuffering}get type(){return this._type}get status(){return this._status}get needStashBuffer(){return this._needStash}get onContentLengthKnown(){return this._onContentLengthKnown}set onContentLengthKnown(e){this._onContentLengthKnown=e}get onURLRedirect(){return this._onURLRedirect}set onURLRedirect(e){this._onURLRedirect=e}get onDataArrival(){return this._onDataArrival}set onDataArrival(e){this._onDataArrival=e}get onError(){return this._onError}set onError(e){this._onError=e}get onComplete(){return this._onComplete}set onComplete(e){this._onComplete=e}open(e,t){throw new g("Unimplemented abstract function!")}abort(){throw new g("Unimplemented abstract function!")}}let S={};!function(){let e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],i=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],r={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:i[0]||""},n={};if(r.browser){n[r.browser]=!0;let e=r.majorVersion.split(".");n.version={major:parseInt(r.majorVersion,10),string:r.version},e.length>1&&(n.version.minor=parseInt(e[1],10)),e.length>2&&(n.version.build=parseInt(e[2],10))}if(r.platform&&(n[r.platform]=!0),(n.chrome||n.opr||n.safari)&&(n.webkit=!0),n.rv||n.iemobile){n.rv&&delete n.rv;let e="msie";r.browser=e,n[e]=!0}if(n.edge){delete n.edge;let e="msedge";r.browser=e,n[e]=!0}if(n.opr){let e="opera";r.browser=e,n[e]=!0}if(n.safari&&n.android){let e="android";r.browser=e,n[e]=!0}n.name=r.browser,n.platform=r.platform;for(let e in S)S.hasOwnProperty(e)&&delete S[e];Object.assign(S,n)}();var b=S;var w=class extends E{static isSupported(){try{let e=b.msedge&&b.version.minor>=15048,t=!b.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(e){return!1}}constructor(e,t){super("fetch-stream-loader"),this.TAG="FetchStreamLoader",this._seekHandler=e,this._config=t,this._needStash=!0,this._requestAbort=!1,this._contentLength=null,this._receivedLength=0}destroy(){this.isWorking()&&this.abort(),super.destroy()}open(e,t){this._dataSource=e,this._range=t;let i=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(i=e.redirectedURL);let r=this._seekHandler.getConfig(i,t),n=new self.Headers;if("object"==typeof r.headers){let e=r.headers;for(let t in e)e.hasOwnProperty(t)&&n.append(t,e[t])}let s={method:"GET",headers:n,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"==typeof this._config.headers)for(let e in this._config.headers)n.append(e,this._config.headers[e]);!1===e.cors&&(s.mode="same-origin"),e.withCredentials&&(s.credentials="include"),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),this._status=v.kConnecting,self.fetch(r.url,s).then(e=>{if(this._requestAbort)return this._requestAbort=!1,void(this._status=v.kIdle);if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==r.url&&this._onURLRedirect){let t=this._seekHandler.removeURLParameters(e.url);this._onURLRedirect(t)}let t=e.headers.get("Content-Length");return null!=t&&(this._contentLength=parseInt(t),0!==this._contentLength&&this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)),this._pump.call(this,e.body.getReader())}if(this._status=v.kError,this.sendError(),!this._onError)throw new _("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);this._onError(y.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})}).catch(e=>{if(this._status=v.kError,!this._onError)throw e;this._onError(y.EXCEPTION,{code:-1,msg:e.message})})}abort(){this._requestAbort=!0}sendError(){this.abort(),self.postMessage({msg:"disconnect"})}_pump(e){return e.read().then(t=>{if(t.done)if(null!==this._contentLength&&this._receivedLength<this._contentLength){this._status=v.kError;let e=y.EARLY_EOF,t={code:-1,msg:"Fetch stream meet Early-EOF"};if(!this._onError)throw new _(t.msg);this._onError(e,t)}else this._status=v.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1);else{if(!0===this._requestAbort)return this._requestAbort=!1,this._status=v.kComplete,e.cancel();this._status=v.kBuffering;let i=t.value.buffer,r=this._range.from+this._receivedLength;this._receivedLength+=i.byteLength,this._onDataArrival&&this._onDataArrival(i,r,this._receivedLength),this._pump(e)}}).catch(e=>{if(11===e.code&&b.msedge)return;this._status=v.kError;let t=0,i=null;if(19!==e.code&&"network error"!==e.message||!(null===this._contentLength||null!==this._contentLength&&this._receivedLength<this._contentLength)?(t=y.EXCEPTION,i={code:e.code,msg:e.message}):(t=y.EARLY_EOF,i={code:e.code,msg:"Fetch stream meet Early-EOF"}),this.sendError(),!this._onError)throw new _(i.msg);this._onError(t,i)})}};var A=class extends E{static isSupported(){try{let e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return c.w("MozChunkedLoader",e.message),!1}}constructor(e,t){super("xhr-moz-chunked-loader"),this.TAG="MozChunkedLoader",this._seekHandler=e,this._config=t,this._needStash=!0,this._xhr=null,this._requestAbort=!1,this._contentLength=null,this._receivedLength=0}destroy(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),super.destroy()}open(e,t){this._dataSource=e,this._range=t;let i=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(i=e.redirectedURL);let r=this._seekHandler.getConfig(i,t);this._requestURL=r.url;let n=this._xhr=new XMLHttpRequest;if(n.open("GET",r.url,!0),n.responseType="moz-chunked-arraybuffer",n.onreadystatechange=this._onReadyStateChange.bind(this),n.onprogress=this._onProgress.bind(this),n.onloadend=this._onLoadEnd.bind(this),n.onerror=this._onXhrError.bind(this),e.withCredentials&&(n.withCredentials=!0),"object"==typeof r.headers){let e=r.headers;for(let t in e)e.hasOwnProperty(t)&&n.setRequestHeader(t,e[t])}if("object"==typeof this._config.headers){let e=this._config.headers;for(let t in e)e.hasOwnProperty(t)&&n.setRequestHeader(t,e[t])}this._status=v.kConnecting,n.send()}abort(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=v.kComplete}_onReadyStateChange(e){let t=e.target;if(2===t.readyState){if(null!=t.responseURL&&t.responseURL!==this._requestURL&&this._onURLRedirect){let e=this._seekHandler.removeURLParameters(t.responseURL);this._onURLRedirect(e)}if(0!==t.status&&(t.status<200||t.status>299)){if(this._status=v.kError,!this._onError)throw new _("MozChunkedLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(y.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else this._status=v.kBuffering}}_onProgress(e){if(this._status===v.kError)return;null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));let t=e.target.response,i=this._range.from+this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,i,this._receivedLength)}_onLoadEnd(e){!0!==this._requestAbort?this._status!==v.kError&&(this._status=v.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1}_onXhrError(e){this._status=v.kError;let t=0,i=null;if(this._contentLength&&e.loaded<this._contentLength?(t=y.EARLY_EOF,i={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(t=y.EXCEPTION,i={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new _(i.msg);this._onError(t,i)}};var R=class extends E{static isSupported(){try{let e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="arraybuffer","arraybuffer"===e.responseType}catch(e){return c.w("RangeLoader",e.message),!1}}constructor(e,t){super("xhr-range-loader"),this.TAG="RangeLoader",this._seekHandler=e,this._config=t,this._needStash=!1,this._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],this._currentChunkSizeKB=384,this._currentSpeedNormalized=0,this._zeroSpeedChunkCount=0,this._xhr=null,this._speedSampler=new f,this._requestAbort=!1,this._waitForTotalLength=!1,this._totalLengthReceived=!1,this._currentRequestURL=null,this._currentRedirectedURL=null,this._currentRequestRange=null,this._totalLength=null,this._contentLength=null,this._receivedLength=0,this._lastTimeLoaded=0}destroy(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),super.destroy()}get currentSpeed(){return this._speedSampler.lastSecondKBps}open(e,t){this._dataSource=e,this._range=t,this._status=v.kConnecting;let i=!1;null!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(i=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||i?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))}_openSubRange(){let e=1024*this._currentChunkSizeKB,t=this._range.from+this._receivedLength,i=t+e;null!=this._contentLength&&i-this._range.from>=this._contentLength&&(i=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:i},this._internalOpen(this._dataSource,this._currentRequestRange)}_internalOpen(e,t){this._lastTimeLoaded=0;let i=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?i=this._currentRedirectedURL:null!=e.redirectedURL&&(i=e.redirectedURL));let r=this._seekHandler.getConfig(i,t);this._currentRequestURL=r.url;let n=this._xhr=new XMLHttpRequest;if(n.open("GET",r.url,!0),n.responseType="arraybuffer",n.onreadystatechange=this._onReadyStateChange.bind(this),n.onprogress=this._onProgress.bind(this),n.onload=this._onLoad.bind(this),n.onerror=this._onXhrError.bind(this),e.withCredentials&&(n.withCredentials=!0),"object"==typeof r.headers){let e=r.headers;for(let t in e)e.hasOwnProperty(t)&&n.setRequestHeader(t,e[t])}if("object"==typeof this._config.headers){let e=this._config.headers;for(let t in e)e.hasOwnProperty(t)&&n.setRequestHeader(t,e[t])}n.send()}abort(){this._requestAbort=!0,this._internalAbort(),this._status=v.kComplete}_internalAbort(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)}_onReadyStateChange(e){let t=e.target;if(2===t.readyState){if(null!=t.responseURL){let e=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&e!==this._currentRedirectedURL&&(this._currentRedirectedURL=e,this._onURLRedirect&&this._onURLRedirect(e))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=v.kBuffering}else{if(this._status=v.kError,!this._onError)throw new _("RangeLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(y.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}}}_onProgress(e){if(this._status===v.kError)return;if(null===this._contentLength){let t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;let i=e.total;this._internalAbort(),null!=i&0!==i&&(this._totalLength=i)}if(-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,t)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}let t=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(t)}_normalizeSpeed(e){let t=this._chunkSizeKBList,i=t.length-1,r=0,n=0,s=i;if(e<t[0])return t[0];for(;n<=s;){if(r=n+Math.floor((s-n)/2),r===i||e>=t[r]&&e<t[r+1])return t[r];t[r]<e?n=r+1:s=r-1}}_onLoad(e){if(this._status===v.kError)return;if(this._waitForTotalLength)return void(this._waitForTotalLength=!1);this._lastTimeLoaded=0;let t=this._speedSampler.lastSecondKBps;if(0===t&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),0!==t){let e=this._normalizeSpeed(t);this._currentSpeedNormalized!==e&&(this._currentSpeedNormalized=e,this._currentChunkSizeKB=e)}let i=e.target.response,r=this._range.from+this._receivedLength;this._receivedLength+=i.byteLength;let n=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():n=!0,this._onDataArrival&&this._onDataArrival(i,r,this._receivedLength),n&&(this._status=v.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}_onXhrError(e){this._status=v.kError;let t=0,i=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=y.EARLY_EOF,i={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=y.EXCEPTION,i={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new _(i.msg);this._onError(t,i)}};var L=class extends E{static isSupported(){try{return void 0!==self.WebSocket}catch(e){return!1}}constructor(){super("websocket-loader"),this.TAG="WebSocketLoader",this._needStash=!0,this._ws=null,this._requestAbort=!1,this._receivedLength=0}destroy(){this._ws&&this.abort(),super.destroy()}open(e){try{let t=this._ws=new self.WebSocket(e.url);t.binaryType="arraybuffer",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=v.kConnecting}catch(e){this._status=v.kError;let t={code:e.code,msg:e.message};if(!this._onError)throw new _(t.msg);this._onError(y.EXCEPTION,t)}}abort(){let e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=v.kComplete}_onWebSocketOpen(e){this._status=v.kBuffering}_onWebSocketClose(e){!0!==this._requestAbort?(this._status=v.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1}_onWebSocketMessage(e){if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){let t=new FileReader;t.onload=()=>{this._dispatchArrayBuffer(t.result)},t.readAsArrayBuffer(e.data)}else{this._status=v.kError;let t={code:-1,msg:"Unsupported WebSocket message type: "+e.data.constructor.name};if(!this._onError)throw new _(t.msg);this._onError(y.EXCEPTION,t)}}_dispatchArrayBuffer(e){let t=e,i=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,i,this._receivedLength)}_onWebSocketError(e){this._status=v.kError;let t={code:e.code,msg:e.message};if(!this._onError)throw new _(t.msg);this._onError(y.EXCEPTION,t)}};var T=class{constructor(e){this._zeroStart=e||!1}getConfig(e,t){let i={};if(0!==t.from||-1!==t.to){let e;e=-1!==t.to?`bytes=${t.from.toString()}-${t.to.toString()}`:`bytes=${t.from.toString()}-`,i.Range=e}else this._zeroStart&&(i.Range="bytes=0-");return{url:e,headers:i}}removeURLParameters(e){return e}};var I=class{constructor(e,t){this._startName=e,this._endName=t}getConfig(e,t){let i=e;if(0!==t.from||-1!==t.to){let e=!0;-1===i.indexOf("?")&&(i+="?",e=!1),e&&(i+="&"),i+=`${this._startName}=${t.from.toString()}`,-1!==t.to&&(i+=`&${this._endName}=${t.to.toString()}`)}return{url:i,headers:{}}}removeURLParameters(e){let t=e.split("?")[0],i=void 0,r=e.indexOf("?");-1!==r&&(i=e.substring(r+1));let n="";if(null!=i&&i.length>0){let e=i.split("&");for(let t=0;t<e.length;t++){let i=e[t].split("="),r=t>0;i[0]!==this._startName&&i[0]!==this._endName&&(r&&(n+="&"),n+=e[t])}}return 0===n.length?t:t+"?"+n}};var k=class{constructor(e,t,i){this.TAG="IOController",this._config=t,this._extraData=i,this._stashInitialSize=393216,null!=t.stashInitialSize&&t.stashInitialSize>0&&(this._stashInitialSize=t.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,!1===t.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new f,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}destroy(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null}isWorking(){return this._loader&&this._loader.isWorking()&&!this._paused}isPaused(){return this._paused}get status(){return this._loader.status}get extraData(){return this._extraData}set extraData(e){this._extraData=e}get onDataArrival(){return this._onDataArrival}set onDataArrival(e){this._onDataArrival=e}get onSeeked(){return this._onSeeked}set onSeeked(e){this._onSeeked=e}get onError(){return this._onError}set onError(e){this._onError=e}get onComplete(){return this._onComplete}set onComplete(e){this._onComplete=e}get onRedirect(){return this._onRedirect}set onRedirect(e){this._onRedirect=e}get onRecoveredEarlyEof(){return this._onRecoveredEarlyEof}set onRecoveredEarlyEof(e){this._onRecoveredEarlyEof=e}get currentURL(){return this._dataSource.url}get hasRedirect(){return null!=this._redirectedURL||null!=this._dataSource.redirectedURL}get currentRedirectedURL(){return this._redirectedURL||this._dataSource.redirectedURL}get currentSpeed(){return this._loaderClass===R?this._loader.currentSpeed:this._speedSampler.lastSecondKBps}get loaderType(){return this._loader.type}_selectSeekHandler(){let e=this._config;if("range"===e.seekType)this._seekHandler=new T(this._config.rangeLoadZeroStart);else if("param"===e.seekType){let t=e.seekParamStart||"bstart",i=e.seekParamEnd||"bend";this._seekHandler=new I(t,i)}else{if("custom"!==e.seekType)throw new p("Invalid seekType in config: "+e.seekType);if("function"!=typeof e.customSeekHandler)throw new p("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}}_selectLoader(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=L;else if(w.isSupported())this._loaderClass=w;else if(A.isSupported())this._loaderClass=A;else{if(!R.isSupported())throw new _("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=R}}_createLoader(){this._loader=new this._loaderClass(this._seekHandler,this._config),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)}open(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))}abort(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)}pause(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)}resume(){if(this._paused){this._paused=!1;let e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}}seek(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)}_internalSeek(e,t){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(t),this._loader.destroy(),this._loader=null;let i={from:e,to:-1};this._currentRange={from:i.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,i),this._onSeeked&&this._onSeeked()}updateUrl(e){if(!e||"string"!=typeof e||0===e.length)throw new p("Url must be a non-empty string!");this._dataSource.url=e}_expandBuffer(e){let t=this._stashSize;for(;t+1048576<e;)t*=2;if(t+=1048576,t===this._bufferSize)return;let i=new ArrayBuffer(t);if(this._stashUsed>0){let e=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(i,0,t).set(e,0)}this._stashBuffer=i,this._bufferSize=t}_normalizeSpeed(e){let t=this._speedNormalizeList,i=t.length-1,r=0,n=0,s=i;if(e<t[0])return t[0];for(;n<=s;){if(r=n+Math.floor((s-n)/2),r===i||e>=t[r]&&e<t[r+1])return t[r];t[r]<e?n=r+1:s=r-1}}_adjustStashSize(e){let t=0;t=this._config.isLive||e<512?e:e>=512&&e<=1024?Math.floor(1.5*e):2*e,t>8192&&(t=8192);let i=1024*t+1048576;this._bufferSize<i&&this._expandBuffer(i),this._stashSize=1024*t}_dispatchChunks(e,t){return this._currentRange.to=t+e.byteLength-1,this._onDataArrival(e,t)}_onURLRedirect(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)}_onContentLengthKnown(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)}_onLoaderChunkArrival(e,t,i){if(!this._onDataArrival)throw new m("IOController: No existing consumer (onDataArrival) callback!");if(this._paused)return;this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);let r=this._speedSampler.lastSecondKBps;if(0!==r){let e=this._normalizeSpeed(r);this._speedNormalized!==e&&(this._speedNormalized=e,this._adjustStashSize(e))}if(this._enableStash)if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize){new Uint8Array(this._stashBuffer,0,this._stashSize).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{let i=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){let t=this._stashBuffer.slice(0,this._stashUsed),r=this._dispatchChunks(t,this._stashByteStart);if(r<t.byteLength){if(r>0){let e=new Uint8Array(t,r);i.set(e,0),this._stashUsed=e.byteLength,this._stashByteStart+=r}}else this._stashUsed=0,this._stashByteStart+=r;this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),i=new Uint8Array(this._stashBuffer,0,this._bufferSize)),i.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{let r=this._dispatchChunks(e,t);if(r<e.byteLength){let n=e.byteLength-r;n>this._bufferSize&&(this._expandBuffer(n),i=new Uint8Array(this._stashBuffer,0,this._bufferSize)),i.set(new Uint8Array(e,r),0),this._stashUsed+=n,this._stashByteStart=t+r}}}else if(0===this._stashUsed){let i=this._dispatchChunks(e,t);if(i<e.byteLength){let r=e.byteLength-i;r>this._bufferSize&&this._expandBuffer(r),new Uint8Array(this._stashBuffer,0,this._bufferSize).set(new Uint8Array(e,i),0),this._stashUsed+=r,this._stashByteStart=t+i}}else{this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength);let t=new Uint8Array(this._stashBuffer,0,this._bufferSize);t.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;let i=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(i<this._stashUsed&&i>0){let e=new Uint8Array(this._stashBuffer,i);t.set(e,0)}this._stashUsed-=i,this._stashByteStart+=i}}_flushStashBuffer(e){if(this._stashUsed>0){let t=this._stashBuffer.slice(0,this._stashUsed),i=this._dispatchChunks(t,this._stashByteStart),r=t.byteLength-i;if(i<t.byteLength){if(!e){if(i>0){let e=new Uint8Array(this._stashBuffer,0,this._bufferSize),r=new Uint8Array(t,i);e.set(r,0),this._stashUsed=r.byteLength,this._stashByteStart+=i}return 0}c.w(this.TAG,r+" bytes unconsumed data remain when flush buffer, dropped")}return this._stashUsed=0,this._stashByteStart=0,r}return 0}_onLoaderComplete(e,t){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)}_onLoaderError(e,t){switch(c.e(this.TAG,`Loader error, code = ${t.code}, msg = ${t.msg}`),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=y.UNRECOVERABLE_EARLY_EOF),e){case y.EARLY_EOF:if(!this._config.isLive&&this._totalLength){let e=this._currentRange.to+1;return void(e<this._totalLength&&(c.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(e,!1)))}e=y.UNRECOVERABLE_EARLY_EOF}if(!this._onError)throw new _("IOException: "+t.msg);this._onError(e,t)}};const x={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function C(){return Object.assign({},x)}class O{static supportMSEH264Playback(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}static supportNetworkStreamIO(){let e=new k({},C()),t=e.loaderType;return e.destroy(),"fetch-stream-loader"==t||"xhr-moz-chunked-loader"==t}static getNetworkLoaderTypeName(){let e=new k({},C()),t=e.loaderType;return e.destroy(),t}static supportNativeMediaPlayback(e){null==O.videoElement&&(O.videoElement=window.document.createElement("video"));let t=O.videoElement.canPlayType(e);return"probably"===t||"maybe"==t}static getFeatureList(){let e={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return e.mseFlvPlayback=O.supportMSEH264Playback(),e.networkStreamIO=O.supportNetworkStreamIO(),e.networkLoaderName=O.getNetworkLoaderTypeName(),e.mseLiveFlvPlayback=e.mseFlvPlayback&&e.networkStreamIO,e.nativeMP4H264Playback=O.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),e.nativeWebmVP8Playback=O.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),e.nativeWebmVP9Playback=O.supportNativeMediaPlayback('video/webm; codecs="vp9"'),e}}var D=O;var M={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};class B{static get forceGlobalTag(){return c.FORCE_GLOBAL_TAG}static set forceGlobalTag(e){c.FORCE_GLOBAL_TAG=e,B._notifyChange()}static get globalTag(){return c.GLOBAL_TAG}static set globalTag(e){c.GLOBAL_TAG=e,B._notifyChange()}static get enableAll(){return c.ENABLE_VERBOSE&&c.ENABLE_DEBUG&&c.ENABLE_INFO&&c.ENABLE_WARN&&c.ENABLE_ERROR}static set enableAll(e){c.ENABLE_VERBOSE=e,c.ENABLE_DEBUG=e,c.ENABLE_INFO=e,c.ENABLE_WARN=e,c.ENABLE_ERROR=e,B._notifyChange()}static get enableDebug(){return c.ENABLE_DEBUG}static set enableDebug(e){c.ENABLE_DEBUG=e,B._notifyChange()}static get enableVerbose(){return c.ENABLE_VERBOSE}static set enableVerbose(e){c.ENABLE_VERBOSE=e,B._notifyChange()}static get enableInfo(){return c.ENABLE_INFO}static set enableInfo(e){c.ENABLE_INFO=e,B._notifyChange()}static get enableWarn(){return c.ENABLE_WARN}static set enableWarn(e){c.ENABLE_WARN=e,B._notifyChange()}static get enableError(){return c.ENABLE_ERROR}static set enableError(e){c.ENABLE_ERROR=e,B._notifyChange()}static getConfig(){return{globalTag:c.GLOBAL_TAG,forceGlobalTag:c.FORCE_GLOBAL_TAG,enableVerbose:c.ENABLE_VERBOSE,enableDebug:c.ENABLE_DEBUG,enableInfo:c.ENABLE_INFO,enableWarn:c.ENABLE_WARN,enableError:c.ENABLE_ERROR,enableCallback:c.ENABLE_CALLBACK}}static applyConfig(e){c.GLOBAL_TAG=e.globalTag,c.FORCE_GLOBAL_TAG=e.forceGlobalTag,c.ENABLE_VERBOSE=e.enableVerbose,c.ENABLE_DEBUG=e.enableDebug,c.ENABLE_INFO=e.enableInfo,c.ENABLE_WARN=e.enableWarn,c.ENABLE_ERROR=e.enableError,c.ENABLE_CALLBACK=e.enableCallback}static _notifyChange(){let e=B.emitter;if(e.listenerCount("change")>0){let t=B.getConfig();e.emit("change",t)}}static registerListener(e){B.emitter.addListener("change",e)}static removeListener(e){B.emitter.removeListener("change",e)}static addLogListener(e){c.emitter.addListener("log",e),c.emitter.listenerCount("log")>0&&(c.ENABLE_CALLBACK=!0,B._notifyChange())}static removeLogListener(e){c.emitter.removeListener("log",e),0===c.emitter.listenerCount("log")&&(c.ENABLE_CALLBACK=!1,B._notifyChange())}}B.emitter=new u.a;var U=B;var P=class{constructor(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}isComplete(){let e=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&null!=this.duration&&null!=this.metadata&&null!=this.hasKeyframesIndex&&e&&t}isSeekable(){return!0===this.hasKeyframesIndex}getNearestKeyframe(e){if(null==this.keyframesIndex)return null;let t=this.keyframesIndex,i=this._search(t.times,e);return{index:i,milliseconds:t.times[i],fileposition:t.filepositions[i]}}_search(e,t){let i=0,r=e.length-1,n=0,s=0,o=r;for(t<e[0]&&(i=0,s=o+1);s<=o;){if(n=s+Math.floor((o-s)/2),n===r||t>=e[n]&&t<e[n+1]){i=n;break}e[n]<t?s=n+1:o=n-1}return i}};function G(e,t,i){let r=e;if(t+i<r.length){for(;i--;)if(128!=(192&r[++t]))return!1;return!0}return!1}var N=function(e){let t=[],i=e,r=0,n=e.length;for(;r<n;)if(i[r]<128)t.push(String.fromCharCode(i[r])),++r;else{if(i[r]<192);else if(i[r]<224){if(G(i,r,1)){let e=(31&i[r])<<6|63&i[r+1];if(e>=128){t.push(String.fromCharCode(65535&e)),r+=2;continue}}}else if(i[r]<240){if(G(i,r,2)){let e=(15&i[r])<<12|(63&i[r+1])<<6|63&i[r+2];if(e>=2048&&55296!=(63488&e)){t.push(String.fromCharCode(65535&e)),r+=3;continue}}}else if(i[r]<248&&G(i,r,3)){let e=(7&i[r])<<18|(63&i[r+1])<<12|(63&i[r+2])<<6|63&i[r+3];if(e>65536&&e<1114112){e-=65536,t.push(String.fromCharCode(e>>>10|55296)),t.push(String.fromCharCode(1023&e|56320)),r+=4;continue}}t.push(String.fromCharCode(65533)),++r}return t.join("")};let F=function(){let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}();class V{static parseScriptData(e,t,i){let r={};try{let n=V.parseValue(e,t,i),s=V.parseValue(e,t+n.size,i-n.size);r[n.data]=s.data}catch(e){c.e("AMF",e.toString())}return r}static parseObject(e,t,i){if(i<3)throw new m("Data not enough when parse ScriptDataObject");let r=V.parseString(e,t,i),n=V.parseValue(e,t+r.size,i-r.size),s=n.objectEnd;return{data:{name:r.data,value:n.data},size:r.size+n.size,objectEnd:s}}static parseVariable(e,t,i){return V.parseObject(e,t,i)}static parseString(e,t,i){if(i<2)throw new m("Data not enough when parse String");let r,n=new DataView(e,t,i).getUint16(0,!F);return r=n>0?N(new Uint8Array(e,t+2,n)):"",{data:r,size:2+n}}static parseLongString(e,t,i){if(i<4)throw new m("Data not enough when parse LongString");let r,n=new DataView(e,t,i).getUint32(0,!F);return r=n>0?N(new Uint8Array(e,t+4,n)):"",{data:r,size:4+n}}static parseDate(e,t,i){if(i<10)throw new m("Data size invalid when parse Date");let r=new DataView(e,t,i),n=r.getFloat64(0,!F);return n+=60*r.getInt16(8,!F)*1e3,{data:new Date(n),size:10}}static parseValue(e,t,i){if(i<1)throw new m("Data not enough when parse Value");let r,n=new DataView(e,t,i),s=1,o=n.getUint8(0),a=!1;try{switch(o){case 0:r=n.getFloat64(1,!F),s+=8;break;case 1:r=!!n.getUint8(1),s+=1;break;case 2:{let n=V.parseString(e,t+1,i-1);r=n.data,s+=n.size;break}case 3:{r={};let o=0;for(9==(16777215&n.getUint32(i-4,!F))&&(o=3);s<i-4;){let n=V.parseObject(e,t+s,i-s-o);if(n.objectEnd)break;r[n.data.name]=n.data.value,s+=n.size}if(s<=i-3){9===(16777215&n.getUint32(s-1,!F))&&(s+=3)}break}case 8:{r={},s+=4;let o=0;for(9==(16777215&n.getUint32(i-4,!F))&&(o=3);s<i-8;){let n=V.parseVariable(e,t+s,i-s-o);if(n.objectEnd)break;r[n.data.name]=n.data.value,s+=n.size}if(s<=i-3){9===(16777215&n.getUint32(s-1,!F))&&(s+=3)}break}case 9:r=void 0,s=1,a=!0;break;case 10:{r=[];let o=n.getUint32(1,!F);s+=4;for(let n=0;n<o;n++){let n=V.parseValue(e,t+s,i-s);r.push(n.data),s+=n.size}break}case 11:{let n=V.parseDate(e,t+1,i-1);r=n.data,s+=n.size;break}case 12:{let n=V.parseString(e,t+1,i-1);r=n.data,s+=n.size;break}default:s=i,c.w("AMF","Unsupported AMF value type "+o)}}catch(e){c.e("AMF",e.toString())}return{data:r,size:s,objectEnd:a}}}var j=V;var W=class{constructor(e){this.TAG="ExpGolomb",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}destroy(){this._buffer=null}_fillCurrentWord(){let e=this._total_bytes-this._buffer_index;if(e<=0)throw new m("ExpGolomb: _fillCurrentWord() but no bytes available");let t=Math.min(4,e),i=new Uint8Array(4);i.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(i.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t}readBits(e){if(e>32)throw new p("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){let t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}let t=this._current_word_bits_left?this._current_word:0;t>>>=32-this._current_word_bits_left;let i=e-this._current_word_bits_left;this._fillCurrentWord();let r=Math.min(i,this._current_word_bits_left),n=this._current_word>>>32-r;return this._current_word<<=r,this._current_word_bits_left-=r,t=t<<r|n,t}readBool(){return 1===this.readBits(1)}readByte(){return this.readBits(8)}_skipLeadingZero(){let e;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()}readUEG(){let e=this._skipLeadingZero();return this.readBits(e+1)-1}readSEG(){let e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)}};var z=class{constructor(e,t){this.m_data=e,this.m_len=t,this.m_idx=0,this.m_bits=0,this.m_byte=0,this.m_zeros=0}GetLeft(){return this.m_len-this.m_idx}GetBYTE(){if(this.m_idx>=this.m_len)return 0;let e=this.m_data[this.m_idx++];return 0==e?(this.m_zeros++,this.m_idx<this.m_len&&2==this.m_zeros&&3==this.m_data[this.m_idx]&&(this.m_idx++,this.m_zeros=0)):this.m_zeros=0,e}GetBit(){return 0==this.m_bits&&(this.m_byte=this.GetBYTE(),this.m_bits=8),this.m_bits--,this.m_byte>>this.m_bits&1}GetWord(e){let t=0;for(;e>0;)t<<=1,t|=this.GetBit(),e--;return t}GetUE(){let e=0;for(;this.m_idx<this.m_len&&0==this.GetBit();)e++;return this.GetWord(e)+((1<<e)-1)}GetSE(){let e=this.GetUE(),t=e+1>>1;return 1&e||(t=-t),t}};class H{static _ebsp2rbsp(e){let t=e,i=t.byteLength,r=new Uint8Array(i),n=0;for(let e=0;e<i;e++)e>=2&&3===t[e]&&0===t[e-1]&&0===t[e-2]||(r[n]=t[e],n++);return new Uint8Array(r.buffer,0,n)}static parseHevcSPS(e){let t=new z(e,e.byteLength);t.GetWord(4);let i=t.GetWord(3);if(i>6)return;t.GetWord(1),t.GetWord(2),t.GetWord(1),t.GetWord(5);t.GetWord(32),t.GetWord(1),t.GetWord(1),t.GetWord(1),t.GetWord(1),t.GetWord(44);t.GetWord(8);let r=new Array,n=new Array;for(let e=0;e<i;e++)r[e]=t.GetWord(1),n[e]=t.GetWord(1);if(i>0)for(let e=i;e<8;e++)t.GetWord(2);for(let e=0;e<i;e++)r[e]&&(t.GetWord(2),t.GetWord(1),t.GetWord(5),t.GetWord(32),t.GetWord(1),t.GetWord(1),t.GetWord(1),t.GetWord(1),t.GetWord(44)),n[e]&&t.GetWord(8);let s=t.GetUE();if(s>15)return!1;let o=t.GetUE();if(s>3)return!1;3==o&&t.GetWord(1);let a=t.GetUE(),h=t.GetUE();t.GetWord(1)&&(t.GetUE(),t.GetUE(),t.GetUE(),t.GetUE());let l=t.GetUE()+8;if(l!=t.GetUE()+8)return!1;let u=t.GetUE();if(u>16)return!1;let d=t.GetWord(1);d=d?0:i;for(let e=d;e<i;e++)t.GetUE(),t.GetUE(),t.GetUE();t.GetUE(),t.GetUE();let c=t.GetUE()+2;t.GetUE(),t.GetUE(),t.GetUE();if(t.GetWord(1)&&t.GetWord(1))for(let e=0;e<4;e++)for(let i=0;i<(3==e?2:6);i++){if(t.GetWord(1)){let i=1<<4+(e<<1),r=0;r=i>64?64:i,e>1&&t.GetSE();for(let e=0;e<r;e++)t.GetSE()}else t.GetUE()}if(t.GetWord(1),t.GetWord(1),t.GetWord(1)){t.GetWord(4),t.GetWord(4);let e=t.GetUE()+3;t.GetUE(),t.GetWord(1)}let f=t.GetUE();if(f>64)return!1;let _=new Array;for(let e=0;e<f;e++){if(t.GetWord(1)&&e){if(e>f)return!1;t.GetWord(1),t.GetUE();_[e]=0;for(let i=0;i<=_[e-1];i++){let i=0,r=t.GetWord(1);r||(i=t.GetWord(1)),(r||i)&&_[e]++}}else{let i=t.GetUE(),r=t.GetUE();if(r+i>2*t.GetLeft())return!1;_[e]=i+r;for(let e=0;e<i;e++)t.GetUE(),t.GetWord(1);for(let e=0;e<r;e++)t.GetUE(),t.GetWord(1)}}if(t.GetWord(1)){let e=t.GetUE();if(e>31)return!1;for(let i=0;i<e;i++){let e=16;u+4<16&&(e=u+4),t.GetWord(e),t.GetWord(1)}}t.GetWord(1),t.GetWord(1);let m=0,p=!0,g=0,v=0;if(t.GetWord(1)){if(t.GetWord(1)){if(255==t.GetWord(8)){t.GetWord(16),t.GetWord(16)}}if(t.GetWord(1)&&t.GetWord(1),t.GetWord(1)){t.GetWord(3),t.GetWord(1);t.GetWord(1)&&t.GetWord(24)}if(t.GetWord(1)&&(t.GetUE(),t.GetUE()),t.GetWord(3),t.GetWord(1)&&(t.GetUE(),t.GetUE(),t.GetUE(),t.GetUE()),t.GetWord(1)){let e=t.GetUE();if(p=!0,g=t.GetUE(),v=2*e,m=g/v,t.GetWord(1)){t.GetUE()}}}return{bit_depth:l,chroma_format:o,chroma_format_string:H.getHevcChromaFormatString(o),frame_rate:{fixed:p,fps:m,fps_den:v,fps_num:g},sar_ratio:{width:a,height:h},codec_size:{width:a,height:h},present_size:{width:a,height:h}}}static parseSPS(e){let t=H._ebsp2rbsp(e),i=new W(t);i.readByte();let r=i.readByte();i.readByte();let n=i.readByte();i.readUEG();let s=H.getProfileString(r),o=H.getLevelString(n),a=1,h=420,l=[0,420,422,444],u=8;if((100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r||138===r||144===r)&&(a=i.readUEG(),3===a&&i.readBits(1),a<=3&&(h=l[a]),u=i.readUEG()+8,i.readUEG(),i.readBits(1),i.readBool())){let e=3!==a?8:12;for(let t=0;t<e;t++)i.readBool()&&(t<6?H._skipScalingList(i,16):H._skipScalingList(i,64))}i.readUEG();let d=i.readUEG();if(0===d)i.readUEG();else if(1===d){i.readBits(1),i.readSEG(),i.readSEG();let e=i.readUEG();for(let t=0;t<e;t++)i.readSEG()}let c=i.readUEG();i.readBits(1);let f=i.readUEG(),_=i.readUEG(),m=i.readBits(1);0===m&&i.readBits(1),i.readBits(1);let p=0,g=0,v=0,y=0;i.readBool()&&(p=i.readUEG(),g=i.readUEG(),v=i.readUEG(),y=i.readUEG());let E=1,S=1,b=0,w=!0,A=0,R=0;if(i.readBool()){if(i.readBool()){let e=i.readByte(),t=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],r=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];e>0&&e<16?(E=t[e-1],S=r[e-1]):255===e&&(E=i.readByte()<<8|i.readByte(),S=i.readByte()<<8|i.readByte())}if(i.readBool()&&i.readBool(),i.readBool()&&(i.readBits(4),i.readBool()&&i.readBits(24)),i.readBool()&&(i.readUEG(),i.readUEG()),i.readBool()){let e=i.readBits(32),t=i.readBits(32);w=i.readBool(),A=t,R=2*e,b=A/R}}let L=1;1===E&&1===S||(L=E/S);let T=0,I=0;if(0===a)T=1,I=2-m;else{T=3===a?1:2,I=(1===a?2:1)*(2-m)}let k=16*(f+1),x=16*(_+1)*(2-m);k-=(p+g)*T,x-=(v+y)*I;let C=Math.ceil(k*L);return i.destroy(),i=null,{profile_string:s,level_string:o,bit_depth:u,ref_frames:c,chroma_format:H.getHevcChromaFormatUnit(h),chroma_format_string:H.getChromaFormatString(h),frame_rate:{fixed:w,fps:b,fps_den:R,fps_num:A},sar_ratio:{width:E,height:S},codec_size:{width:k,height:x},present_size:{width:C,height:x}}}static _skipScalingList(e,t){let i=8,r=8,n=0;for(let s=0;s<t;s++)0!==r&&(n=e.readSEG(),r=(i+n+256)%256),i=0===r?i:r}static getProfileString(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}static getLevelString(e){return(e/10).toFixed(1)}static getChromaFormatString(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}static getHevcChromaFormatString(e){switch(e){case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}}static getHevcChromaFormatUnit(e){switch(e){case 1:return 420;case 2:return 422;case 3:return 444;default:return 0}}}var K=H;var q={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};class ${constructor(e,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new P,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}()}destroy(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null}static probe(e){let t=new Uint8Array(e),i={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return i;let r=(4&t[4])>>>2!=0,n=0!=(1&t[4]),s=(o=t)[a=5]<<24|o[a+1]<<16|o[a+2]<<8|o[a+3];var o,a;return s<9?i:{match:!0,consumed:s,dataOffset:s,hasAudioTrack:r,hasVideoTrack:n}}bindDataSource(e){return e.onDataArrival=this.parseChunks.bind(this),this}get onTrackMetadata(){return this._onTrackMetadata}set onTrackMetadata(e){this._onTrackMetadata=e}get onMediaInfo(){return this._onMediaInfo}set onMediaInfo(e){this._onMediaInfo=e}get onMetaDataArrived(){return this._onMetaDataArrived}set onMetaDataArrived(e){this._onMetaDataArrived=e}get onScriptDataArrived(){return this._onScriptDataArrived}set onScriptDataArrived(e){this._onScriptDataArrived=e}get onError(){return this._onError}set onError(e){this._onError=e}get onDataAvailable(){return this._onDataAvailable}set onDataAvailable(e){this._onDataAvailable=e}get timestampBase(){return this._timestampBase}set timestampBase(e){this._timestampBase=e}get overridedDuration(){return this._duration}set overridedDuration(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e}set overridedHasAudio(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e}set overridedHasVideo(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e}resetMediaInfo(){this._mediaInfo=new P}_isInitialMetadataDispatched(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched}parseChunks(e,t){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new m("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");let i=0,r=this._littleEndian;if(0===t){if(!(e.byteLength>13))return 0;i=$.probe(e).dataOffset}if(this._firstParse){this._firstParse=!1,t+i!==this._dataOffset&&c.w(this.TAG,"First time parsing but chunk byteStart invalid!"),0!==new DataView(e,i).getUint32(0,!r)&&c.w(this.TAG,"PrevTagSize0 !== 0 !!!"),i+=4}for(;i<e.byteLength;){this._dispatch=!0;let n=new DataView(e,i);if(i+11+4>e.byteLength)break;let s=n.getUint8(0),o=16777215&n.getUint32(0,!r);if(i+11+o+4>e.byteLength)break;if(8!==s&&9!==s&&18!==s){c.w(this.TAG,`Unsupported tag type ${s}, skipped`),i+=11+o+4;continue}let a=n.getUint8(4),h=n.getUint8(5),l=n.getUint8(6)|h<<8|a<<16|n.getUint8(7)<<24;0!==(16777215&n.getUint32(7,!r))&&c.w(this.TAG,"Meet tag which has StreamID != 0!");let u=i+11;switch(s){case 8:this._parseAudioData(e,u,o,l);break;case 9:this._parseVideoData(e,u,o,l,t+i);break;case 18:this._parseScriptData(e,u,o)}let d=n.getUint32(11+o,!r);d!==11+o&&c.w(this.TAG,"Invalid PrevTagSize "+d),i+=11+o+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),i}_parseScriptData(e,t,i){let r=j.parseScriptData(e,t,i);if(r.hasOwnProperty("onMetaData")){if(null==r.onMetaData||"object"!=typeof r.onMetaData)return void c.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&c.w(this.TAG,"Found another onMetaData tag!"),this._metadata=r;let e=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},e)),"boolean"==typeof e.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=e.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),"boolean"==typeof e.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=e.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),"number"==typeof e.audiodatarate&&(this._mediaInfo.audioDataRate=e.audiodatarate),"number"==typeof e.videodatarate&&(this._mediaInfo.videoDataRate=e.videodatarate),"number"==typeof e.width&&(this._mediaInfo.width=e.width),"number"==typeof e.height&&(this._mediaInfo.height=e.height),"number"==typeof e.duration){if(!this._durationOverrided){let t=Math.floor(e.duration*this._timescale);this._duration=t,this._mediaInfo.duration=t}}else this._mediaInfo.duration=0;if("number"==typeof e.framerate){let t=Math.floor(1e3*e.framerate);if(t>0){let e=t/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=e,this._referenceFrameRate.fps_num=t,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=e}}if("object"==typeof e.keyframes){this._mediaInfo.hasKeyframesIndex=!0;let t=e.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(t),e.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=e,c.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(r).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},r))}_parseKeyframesIndex(e){let t=[],i=[];for(let r=1;r<e.times.length;r++){let n=this._timestampBase+Math.floor(1e3*e.times[r]);t.push(n),i.push(e.filepositions[r])}return{times:t,filepositions:i}}_parseAudioData(e,t,i,r){if(i<=1)return void c.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");if(!0===this._hasAudioFlagOverrided&&!1===this._hasAudio)return;this._littleEndian;let n=new DataView(e,t,i).getUint8(0),s=n>>>4;if(2!==s&&10!==s)return void this._onError(q.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+s);let o=0,a=(12&n)>>>2;if(!(a>=0&&a<=4))return void this._onError(q.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+a);o=this._flvSoundRateTable[a];let h=1&n,l=this._audioMetadata,u=this._audioTrack;if(l||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),l=this._audioMetadata={},l.type="audio",l.id=u.id,l.timescale=this._timescale,l.duration=this._duration,l.audioSampleRate=o,l.channelCount=0===h?1:2),10===s){let n=this._parseAACAudioData(e,t+1,i-1);if(null==n)return;if(0===n.packetType){l.config&&c.w(this.TAG,"Found another AudioSpecificConfig!");let e=n.data;l.audioSampleRate=e.samplingRate,l.channelCount=e.channelCount,l.codec=e.codec,l.originalCodec=e.originalCodec,l.config=e.config,l.refSampleDuration=1024/l.audioSampleRate*l.timescale,c.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",l);let t=this._mediaInfo;t.audioCodec=l.originalCodec,t.audioSampleRate=l.audioSampleRate,t.audioChannelCount=l.channelCount,t.hasVideo?null!=t.videoCodec&&(t.mimeType='video/x-flv; codecs="'+t.videoCodec+","+t.audioCodec+'"'):t.mimeType='video/x-flv; codecs="'+t.audioCodec+'"',t.isComplete()&&this._onMediaInfo(t)}else if(1===n.packetType){let e=this._timestampBase+r,t={unit:n.data,length:n.data.byteLength,dts:e,pts:e};u.samples.push(t),u.length+=n.data.length}else c.e(this.TAG,"Flv: Unsupported AAC data type "+n.packetType)}else if(2===s){if(!l.codec){let r=this._parseMP3AudioData(e,t+1,i-1,!0);if(null==r)return;l.audioSampleRate=r.samplingRate,l.channelCount=r.channelCount,l.codec=r.codec,l.originalCodec=r.originalCodec,l.refSampleDuration=1152/l.audioSampleRate*l.timescale,c.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",l);let n=this._mediaInfo;n.audioCodec=l.codec,n.audioSampleRate=l.audioSampleRate,n.audioChannelCount=l.channelCount,n.audioDataRate=r.bitRate,n.hasVideo?null!=n.videoCodec&&(n.mimeType='video/x-flv; codecs="'+n.videoCodec+","+n.audioCodec+'"'):n.mimeType='video/x-flv; codecs="'+n.audioCodec+'"',n.isComplete()&&this._onMediaInfo(n)}let n=this._parseMP3AudioData(e,t+1,i-1,!1);if(null==n)return;let s=this._timestampBase+r,o={unit:n,length:n.byteLength,dts:s,pts:s};u.samples.push(o),u.length+=n.length}}_parseAACAudioData(e,t,i){if(i<=1)return void c.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");let r={},n=new Uint8Array(e,t,i);return r.packetType=n[0],0===n[0]?r.data=this._parseAACAudioSpecificConfig(e,t+1,i-1):r.data=n.subarray(1),r}_parseAACAudioSpecificConfig(e,t,i){let r=new Uint8Array(e,t,i),n=null,s=0,o=0,a=null,h=0,l=null;if(s=o=r[0]>>>3,h=(7&r[0])<<1|r[1]>>>7,h<0||h>=this._mpegSamplingRates.length)return void this._onError(q.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");let u=this._mpegSamplingRates[h],d=(120&r[1])>>>3;if(d<0||d>=8)return void this._onError(q.FORMAT_ERROR,"Flv: AAC invalid channel configuration");5===s&&(l=(7&r[1])<<1|r[2]>>>7,a=(124&r[2])>>>2);let c=self.navigator.userAgent.toLowerCase();return-1!==c.indexOf("firefox")?h>=6?(s=5,n=new Array(4),l=h-3):(s=2,n=new Array(2),l=h):-1!==c.indexOf("android")?(s=2,n=new Array(2),l=h):(s=5,l=h,n=new Array(4),h>=6?l=h-3:1===d&&(s=2,n=new Array(2),l=h)),n[0]=s<<3,n[0]|=(15&h)>>>1,n[1]=(15&h)<<7,n[1]|=(15&d)<<3,5===s&&(n[1]|=(15&l)>>>1,n[2]=(1&l)<<7,n[2]|=8,n[3]=0),{config:n,samplingRate:u,channelCount:d,codec:"mp4a.40."+s,originalCodec:"mp4a.40."+o}}_parseMP3AudioData(e,t,i,r){if(i<4)return void c.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");this._littleEndian;let n=new Uint8Array(e,t,i),s=null;if(r){if(255!==n[0])return;let e=n[1]>>>3&3,t=(6&n[1])>>1,i=(240&n[2])>>>4,r=(12&n[2])>>>2,o=3!==(n[3]>>>6&3)?2:1,a=0,h=0,l=34,u="mp3";switch(e){case 0:a=this._mpegAudioV25SampleRateTable[r];break;case 2:a=this._mpegAudioV20SampleRateTable[r];break;case 3:a=this._mpegAudioV10SampleRateTable[r]}switch(t){case 1:l=34,i<this._mpegAudioL3BitRateTable.length&&(h=this._mpegAudioL3BitRateTable[i]);break;case 2:l=33,i<this._mpegAudioL2BitRateTable.length&&(h=this._mpegAudioL2BitRateTable[i]);break;case 3:l=32,i<this._mpegAudioL1BitRateTable.length&&(h=this._mpegAudioL1BitRateTable[i])}s={bitRate:h,samplingRate:a,channelCount:o,codec:u,originalCodec:u}}else s=n;return s}_parseVideoData(e,t,i,r,n){if(i<=1)return void c.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");if(!0===this._hasVideoFlagOverrided&&!1===this._hasVideo)return;let s=new Uint8Array(e,t,i)[0],o=(240&s)>>>4,a=15&s;7===a||12===a?this._parseAVCVideoPacket(a,e,t+1,i-1,r,n,o):this._onError(q.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+a)}_parseAVCVideoPacket(e,t,i,r,n,s,o){if(r<4)return void c.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");let a=this._littleEndian,h=new DataView(t,i,r),l=h.getUint8(0),u=(16777215&h.getUint32(0,!a))<<8>>8;if(7==e){if(0===l)this._parseAVCDecoderConfigurationRecord(t,i+4,r-4);else if(1===l)this._parseAVCVideoData(t,i+4,r-4,n,s,o,u);else if(2!==l)return void this._onError(q.FORMAT_ERROR,"Flv: Invalid video packet type "+l)}else if(0===l)this._parseHEVCDecoderConfigurationRecord(t,i+4,r-4);else if(1===l)this._parseAVCVideoData(t,i+4,r-4,n,s,o,u);else if(2!==l)return void this._onError(q.FORMAT_ERROR,"Flv: Invalid video packet type "+l)}_parseHEVCDecoderConfigurationRecord(e,t,i){if(i<22)return void c.w(this.TAG,"Flv: Invalid _parseHEVCDecoderConfigurationRecord, lack of data!");let r=this._videoMetadata,n=this._videoTrack,s=this._littleEndian;r?void 0!==r.avcc&&c.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),r=this._videoMetadata={},r.type="video",r.id=n.id,r.timescale=this._timescale,r.duration=this._duration,r.propty="hevc");let o=new DataView(e,t,i),a=new Uint8Array(e,t,i),h=new z(a,a.byteLength),l=(o.getUint8(0),o.getUint8(1),h.GetWord(2),h.GetWord(1),h.GetWord(5)),u=(h.GetWord(32),h.GetWord(48),h.GetWord(8));h.GetWord(4);h.GetWord(12);h.GetWord(6);h.GetWord(2);h.GetWord(6);let d=h.GetWord(2);h.GetWord(5);let f=h.GetWord(3),_=(h.GetWord(3),h.GetWord(16),h.GetWord(2),h.GetWord(3),h.GetWord(1),h.GetWord(2),o.getUint8(22)),m=23;for(let i=0;i<_;i++){o.getUint8(m);m+=1;let i=o.getUint16(m,!s);m+=2;for(let n=0;n<i;n++){let i=o.getUint16(m,!s);m+=2;let n=new DataView(e,t+m,i),a=new Uint8Array(e,t+m,i);m+=i;let h=n.getUint8(0);if(66==h){let e=K.parseHevcSPS(a);r.codecWidth=e.codec_size.width,r.codecHeight=e.codec_size.height,r.presentWidth=e.present_size.width,r.presentHeight=e.present_size.height,r.profile=l,r.level=u,r.bitDepth=f,r.chromaFormat=d,r.sarRatio=e.sar_ratio,!1!==e.frame_rate.fixed&&0!==e.frame_rate.fps_num&&0!==e.frame_rate.fps_den||(r.frameRate=this._referenceFrameRate);a.subarray(1,4)}else if(68==h);else if(64==h){n.getUint8(6),n.getUint8(20),n.getUint8(12);r.codec="hev1."+n.getUint8(6).toString()+".6.L"+n.getUint8(20).toString()+"."+n.getUint8(12).toString(16)}}}let p=this._mediaInfo;p.width=r.codecWidth,p.height=r.codecHeight,p.fps=25,p.sarNum=r.sarRatio.width,p.sarDen=r.sarRatio.height,p.videoCodec=r.codec,p.hasAudio?null!=p.audioCodec&&(p.mimeType='video/x-flv; codecs="'+p.videoCodec+","+p.audioCodec+'"'):p.mimeType='video/x-flv; codecs="'+p.videoCodec+'"',p.isComplete()&&this._onMediaInfo(p),r.hvcc=new Uint8Array(i),r.hvcc.set(new Uint8Array(e,t,i),0),c.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",r)}_parseAVCDecoderConfigurationRecord(e,t,i){if(i<7)return void c.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");let r=this._videoMetadata,n=this._videoTrack,s=this._littleEndian,o=new DataView(e,t,i);r?void 0!==r.avcc&&c.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),r=this._videoMetadata={},r.type="video",r.id=n.id,r.timescale=this._timescale,r.duration=this._duration,r.propty="avc");let a=o.getUint8(0),h=o.getUint8(1);o.getUint8(2),o.getUint8(3);if(1!==a||0===h)return void this._onError(q.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");if(this._naluLengthSize=1+(3&o.getUint8(4)),3!==this._naluLengthSize&&4!==this._naluLengthSize)return void this._onError(q.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));let l=31&o.getUint8(5);if(0===l)return void this._onError(q.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");l>1&&c.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+l);let u=6;for(let i=0;i<l;i++){let n=o.getUint16(u,!s);if(u+=2,0===n)continue;let a=new Uint8Array(e,t+u,n);u+=n;let h=K.parseSPS(a);if(0!==i)continue;r.codecWidth=h.codec_size.width,r.codecHeight=h.codec_size.height,r.presentWidth=h.present_size.width,r.presentHeight=h.present_size.height,r.profile=h.profile_string,r.level=h.level_string,r.bitDepth=h.bit_depth,r.chromaFormat=h.chroma_format,r.sarRatio=h.sar_ratio,r.frameRate=h.frame_rate,!1!==h.frame_rate.fixed&&0!==h.frame_rate.fps_num&&0!==h.frame_rate.fps_den||(r.frameRate=this._referenceFrameRate);let l=r.frameRate.fps_den,d=r.frameRate.fps_num;r.refSampleDuration=r.timescale*(l/d);let c=a.subarray(1,4),f="avc1.";for(let e=0;e<3;e++){let t=c[e].toString(16);t.length<2&&(t="0"+t),f+=t}r.codec=f;let _=this._mediaInfo;_.width=r.codecWidth,_.height=r.codecHeight,_.fps=r.frameRate.fps,_.profile=r.profile,_.level=r.level,_.refFrames=h.ref_frames,_.chromaFormat=h.chroma_format_string,_.sarNum=r.sarRatio.width,_.sarDen=r.sarRatio.height,_.videoCodec=f,_.hasAudio?null!=_.audioCodec&&(_.mimeType='video/x-flv; codecs="'+_.videoCodec+","+_.audioCodec+'"'):_.mimeType='video/x-flv; codecs="'+_.videoCodec+'"',_.isComplete()&&this._onMediaInfo(_)}let d=o.getUint8(u);if(0!==d){d>1&&c.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+d),u++;for(let e=0;e<d;e++){let e=o.getUint16(u,!s);u+=2,0!==e&&(u+=e)}r.avcc=new Uint8Array(i),r.avcc.set(new Uint8Array(e,t,i),0),c.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",r)}else this._onError(q.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}_parseAVCVideoData(e,t,i,r,n,s,o){let a=this._littleEndian,h=new DataView(e,t,i),l=[],u=0,d=0;const f=this._naluLengthSize;let _=this._timestampBase+r,m=1===s;for(;d<i;){if(d+4>=i){c.w(this.TAG,`Malformed Nalu near timestamp ${_}, offset = ${d}, dataSize = ${i}`);break}let r=h.getUint32(d,!a);if(3===f&&(r>>>=8),r>i-f)return void c.w(this.TAG,`Malformed Nalus near timestamp ${_}, NaluSize > DataSize!`);let n=31&h.getUint8(d+f);5===n&&(m=!0);let s=new Uint8Array(e,t+d,f+r),o={type:n,data:s};l.push(o),u+=s.byteLength,d+=f+r}if(l.length){let e=this._videoTrack,t={units:l,length:u,isKeyframe:m,dts:_,cts:o,pts:_+o};m&&(t.fileposition=n),e.samples.push(t),e.length+=u}}}var Y=$;class X{static init(){X.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],hvcC:[],hvc1:[],fiel:[],pasp:[],".mp3":[]};for(let e in X.types)X.types.hasOwnProperty(e)&&(X.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);let e=X.constants={};e.FIEL=new Uint8Array([1,0]),e.PASP=new Uint8Array([32,32,2,128,32,32,2,127]),e.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),e.HVCFTYP=new Uint8Array([105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49]),e.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),e.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSC=e.STCO=e.STTS,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),e.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),e.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}static box(e){let t=8,i=null,r=Array.prototype.slice.call(arguments,1),n=r.length;for(let e=0;e<n;e++)t+=r[e].byteLength;i=new Uint8Array(t),i[0]=t>>>24&255,i[1]=t>>>16&255,i[2]=t>>>8&255,i[3]=255&t,i.set(e,4);let s=8;for(let e=0;e<n;e++)i.set(r[e],s),s+=r[e].byteLength;return i}static generateInitSegment(e){let t=null;if("avc"==e.propty)t=X.box(X.types.ftyp,X.constants.FTYP);else{if("hevc"!=e.propty)return!1;t=X.box(X.types.ftyp,X.constants.HVCFTYP)}let i=X.moov(e),r=new Uint8Array(t.byteLength+i.byteLength);return r.set(t,0),r.set(i,t.byteLength),r}static moov(e){let t=X.mvhd(e.timescale,e.duration),i=X.trak(e),r=X.mvex(e);return X.box(X.types.moov,t,i,r)}static mvhd(e,t){return X.box(X.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}static trak(e){return X.box(X.types.trak,X.tkhd(e),X.mdia(e))}static tkhd(e){let t=e.id,i=e.duration,r=e.presentWidth,n=e.presentHeight;return X.box(X.types.tkhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>>8&255,255&r,0,0,n>>>8&255,255&n,0,0]))}static mdia(e){return X.box(X.types.mdia,X.mdhd(e),X.hdlr(e),X.minf(e))}static mdhd(e){let t=e.timescale,i=e.duration;return X.box(X.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,i>>>24&255,i>>>16&255,i>>>8&255,255&i,85,196,0,0]))}static hdlr(e){let t=null;return t="audio"===e.type?X.constants.HDLR_AUDIO:X.constants.HDLR_VIDEO,X.box(X.types.hdlr,t)}static minf(e){let t=null;return t="audio"===e.type?X.box(X.types.smhd,X.constants.SMHD):X.box(X.types.vmhd,X.constants.VMHD),X.box(X.types.minf,t,X.dinf(),X.stbl(e))}static dinf(){return X.box(X.types.dinf,X.box(X.types.dref,X.constants.DREF))}static stbl(e){return X.box(X.types.stbl,X.stsd(e),X.box(X.types.stts,X.constants.STTS),X.box(X.types.stsc,X.constants.STSC),X.box(X.types.stsz,X.constants.STSZ),X.box(X.types.stco,X.constants.STCO))}static stsd(e){return"audio"===e.type?"mp3"===e.codec?X.box(X.types.stsd,X.constants.STSD_PREFIX,X.mp3(e)):X.box(X.types.stsd,X.constants.STSD_PREFIX,X.mp4a(e)):"avc"==e.propty?X.box(X.types.stsd,X.constants.STSD_PREFIX,X.avc1(e)):"hevc"==e.propty?X.box(X.types.stsd,X.constants.STSD_PREFIX,X.hvc1(e)):void 0}static mp3(e){let t=e.channelCount,i=e.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return X.box(X.types[".mp3"],r)}static mp4a(e){let t=e.channelCount,i=e.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return X.box(X.types.mp4a,r,X.esds(e))}static esds(e){let t=e.config||[],i=t.length,r=new Uint8Array([0,0,0,0,3,23+i,0,1,0,4,15+i,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([i]).concat(t).concat([6,1,2]));return X.box(X.types.esds,r)}static hvc1(e){let t=e.hvcc,i=e.codecWidth,r=e.codecHeight,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>>8&255,255&i,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return X.box(X.types.hvc1,n,X.box(X.types.hvcC,t),X.box(X.types.fiel,X.constants.FIEL),X.box(X.types.pasp,X.constants.PASP))}static avc1(e){let t=e.avcc,i=e.codecWidth,r=e.codecHeight,n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>>8&255,255&i,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return X.box(X.types.avc1,n,X.box(X.types.avcC,t))}static mvex(e){return X.box(X.types.mvex,X.trex(e))}static trex(e){let t=e.id,i=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return X.box(X.types.trex,i)}static moof(e,t){return X.box(X.types.moof,X.mfhd(e.sequenceNumber),X.traf(e,t))}static mfhd(e){let t=new Uint8Array([0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e]);return X.box(X.types.mfhd,t)}static traf(e,t){let i=e.id,r=X.box(X.types.tfhd,new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i])),n=X.box(X.types.tfdt,new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t])),s=X.sdtp(e),o=X.trun(e,s.byteLength+16+16+8+16+8+8);return X.box(X.types.traf,r,n,o,s)}static sdtp(e){let t=e.samples||[],i=t.length,r=new Uint8Array(4+i);for(let e=0;e<i;e++){let i=t[e].flags;r[e+4]=i.isLeading<<6|i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy}return X.box(X.types.sdtp,r)}static trun(e,t){let i=e.samples||[],r=i.length,n=12+16*r,s=new Uint8Array(n);t+=8+n,s.set([0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0);for(let e=0;e<r;e++){let t=i[e].duration,r=i[e].size,n=i[e].flags,o=i[e].cts;s.set([t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n.isLeading<<2|n.dependsOn,n.isDependedOn<<6|n.hasRedundancy<<4|n.isNonSync,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o],12+16*e)}return X.box(X.types.trun,s)}static mdat(e){return X.box(X.types.mdat,e)}}X.init();var Z=X;var J=class{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}};class Q{constructor(e,t,i,r,n){this.dts=e,this.pts=t,this.duration=i,this.originalDts=r,this.isSyncPoint=n,this.fileposition=null}}class ee{constructor(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}appendSyncPoint(e){e.isSyncPoint=!0,this.syncPoints.push(e)}}class te{constructor(){this._list=[]}clear(){this._list=[]}appendArray(e){let t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))}getLastSyncPointBeforeDts(e){if(0==this._list.length)return null;let t=this._list,i=0,r=t.length-1,n=0,s=0,o=r;for(e<t[0].dts&&(i=0,s=o+1);s<=o;){if(n=s+Math.floor((o-s)/2),n===r||e>=t[n].dts&&e<t[n+1].dts){i=n;break}t[n].dts<e?s=n+1:o=n-1}return this._list[i]}}class ie{constructor(e){this._type=e,this._list=[],this._lastAppendLocation=-1}get type(){return this._type}get length(){return this._list.length}isEmpty(){return 0===this._list.length}clear(){this._list=[],this._lastAppendLocation=-1}_searchNearestSegmentBefore(e){let t=this._list;if(0===t.length)return-2;let i=t.length-1,r=0,n=0,s=i,o=0;if(e<t[0].originalBeginDts)return o=-1,o;for(;n<=s;){if(r=n+Math.floor((s-n)/2),r===i||e>t[r].lastSample.originalDts&&e<t[r+1].originalBeginDts){o=r;break}t[r].originalBeginDts<e?n=r+1:s=r-1}return o}_searchNearestSegmentAfter(e){return this._searchNearestSegmentBefore(e)+1}append(e){let t=this._list,i=e,r=this._lastAppendLocation,n=0;-1!==r&&r<t.length&&i.originalBeginDts>=t[r].lastSample.originalDts&&(r===t.length-1||r<t.length-1&&i.originalBeginDts<t[r+1].originalBeginDts)?n=r+1:t.length>0&&(n=this._searchNearestSegmentBefore(i.originalBeginDts)+1),this._lastAppendLocation=n,this._list.splice(n,0,i)}getLastSegmentBefore(e){let t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null}getLastSampleBefore(e){let t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null}getLastSyncPointBefore(e){let t=this._searchNearestSegmentBefore(e),i=this._list[t].syncPoints;for(;0===i.length&&t>0;)t--,i=this._list[t].syncPoints;return i.length>0?i[i.length-1]:null}}var re=class{constructor(e){this.TAG="MP4Remuxer",this._config=e,this._isLive=!0===e.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new ie("audio"),this._videoSegmentInfoList=new ie("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!b.chrome||!(b.version.major<50||50===b.version.major&&b.version.build<2661)),this._fillSilentAfterSeek=b.msedge||b.msie,this._mp3UseMpegAudio=!b.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}destroy(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null}bindDataSource(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this}get onInitSegment(){return this._onInitSegment}set onInitSegment(e){this._onInitSegment=e}get onMediaSegment(){return this._onMediaSegment}set onMediaSegment(e){this._onMediaSegment=e}insertDiscontinuity(){this._audioNextDts=this._videoNextDts=void 0}seek(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()}remux(e,t){if(!this._onMediaSegment)throw new m("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,t),this._remuxVideo(t),this._remuxAudio(e)}_onTrackMetadataReceived(e,t){let i=null,r="mp4",n=t.codec;if("audio"===e)this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(r="mpeg",n="",i=new Uint8Array):i=Z.generateInitSegment(t);else{if("video"!==e)return;this._videoMeta=t,i=Z.generateInitSegment(t)}if(!this._onInitSegment)throw new m("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:i.buffer,codec:n,container:`${e}/${r}`,mediaDuration:t.duration})}_calculateDtsBase(e,t){this._dtsBaseInited||(e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)}flushStashedSamples(){let e=this._videoStashedLastSample,t=this._audioStashedLastSample,i={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(i.samples.push(e),i.length=e.length);let r={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(r.samples.push(t),r.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(i,!0),this._remuxAudio(r,!0)}_remuxAudio(e,t){if(null==this._audioMeta)return;let i=e,r=i.samples,n=void 0,s=-1,o=-1,a=this._audioMeta.refSampleDuration,h="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,l=this._dtsBaseInited&&void 0===this._audioNextDts,u=!1;if(!r||0===r.length)return;if(1===r.length&&!t)return;let d=0,f=null,_=0;h?(d=0,_=i.length):(d=8,_=8+i.length);let m=null;if(r.length>1&&(m=r.pop(),_-=m.length),null!=this._audioStashedLastSample){let e=this._audioStashedLastSample;this._audioStashedLastSample=null,r.unshift(e),_+=e.length}null!=m&&(this._audioStashedLastSample=m);let p=r[0].dts-this._dtsBase;if(this._audioNextDts)n=p-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())n=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(u=!0);else{let e=this._audioSegmentInfoList.getLastSampleBefore(p);if(null!=e){let t=p-(e.originalDts+e.duration);t<=3&&(t=0),n=p-(e.dts+e.duration+t)}else n=0}if(u){let e=p-n,t=this._videoSegmentInfoList.getLastSegmentBefore(p);if(null!=t&&t.beginDts<e){let i=J.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(i){let n=t.beginDts,s=e-t.beginDts;c.v(this.TAG,`InsertPrefixSilentAudio: dts: ${n}, duration: ${s}`),r.unshift({unit:i,dts:n,pts:n}),_+=i.byteLength}}else u=!1}let g=[];for(let e=0;e<r.length;e++){let t=r[e],i=t.unit,o=t.dts-this._dtsBase,h=o-n;-1===s&&(s=h);let l=0;if(e!==r.length-1){l=r[e+1].dts-this._dtsBase-n-h}else if(null!=m){l=m.dts-this._dtsBase-n-h}else l=g.length>=1?g[g.length-1].duration:Math.floor(a);let u=!1,d=null;if(l>1.5*a&&"mp3"!==this._audioMeta.codec&&this._fillAudioTimestampGap&&!b.safari){u=!0;let e=Math.abs(l-a),t=Math.ceil(e/a),r=h+a;c.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\ndts: ${h+l} ms, expected: ${h+Math.round(a)} ms, delta: ${Math.round(e)} ms, generate: ${t} frames`);let n=J.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);null==n&&(c.w(this.TAG,`Unable to generate silent frame for ${this._audioMeta.originalCodec} with ${this._audioMeta.channelCount} channels, repeat last frame`),n=i),d=[];for(let e=0;e<t;e++){let e=Math.round(r);if(d.length>0){let t=d[d.length-1];t.duration=e-t.dts}let t={dts:e,pts:e,cts:0,unit:n,size:n.byteLength,duration:0,originalDts:o,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};d.push(t),_+=t.size,r+=a}let s=d[d.length-1];s.duration=h+l-s.dts,l=Math.round(a)}g.push({dts:h,pts:h,cts:0,unit:t.unit,size:t.unit.byteLength,duration:l,originalDts:o,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),u&&g.push.apply(g,d)}h?f=new Uint8Array(_):(f=new Uint8Array(_),f[0]=_>>>24&255,f[1]=_>>>16&255,f[2]=_>>>8&255,f[3]=255&_,f.set(Z.types.mdat,4));for(let e=0;e<g.length;e++){let t=g[e].unit;f.set(t,d),d+=t.byteLength}let v=g[g.length-1];o=v.dts+v.duration,this._audioNextDts=o;let y=new ee;y.beginDts=s,y.endDts=o,y.beginPts=s,y.endPts=o,y.originalBeginDts=g[0].originalDts,y.originalEndDts=v.originalDts+v.duration,y.firstSample=new Q(g[0].dts,g[0].pts,g[0].duration,g[0].originalDts,!1),y.lastSample=new Q(v.dts,v.pts,v.duration,v.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(y),i.samples=g,i.sequenceNumber++;let E=null;E=h?new Uint8Array:Z.moof(i,s),i.samples=[],i.length=0;let S={type:"audio",data:this._mergeBoxes(E,f).buffer,sampleCount:g.length,info:y};h&&l&&(S.timestampOffset=s),this._onMediaSegment("audio",S)}_remuxVideo(e,t){if(null==this._videoMeta)return;let i=e,r=i.samples,n=void 0,s=-1,o=-1,a=-1,h=-1;if(!r||0===r.length)return;if(1===r.length&&!t)return;let l=8,u=null,d=8+e.length,c=null;if(r.length>1&&(c=r.pop(),d-=c.length),null!=this._videoStashedLastSample){let e=this._videoStashedLastSample;this._videoStashedLastSample=null,r.unshift(e),d+=e.length}null!=c&&(this._videoStashedLastSample=c);let f=r[0].dts-this._dtsBase;if(this._videoNextDts)n=f-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())n=0;else{let e=this._videoSegmentInfoList.getLastSampleBefore(f);if(null!=e){let t=f-(e.originalDts+e.duration);t<=3&&(t=0),n=f-(e.dts+e.duration+t)}else n=0}let _=new ee,m=[];for(let e=0;e<r.length;e++){let t=r[e],i=t.dts-this._dtsBase,o=t.isKeyframe,h=i-n,l=t.cts,u=h+l;-1===s&&(s=h,a=u);let d=0;if(e!==r.length-1){d=r[e+1].dts-this._dtsBase-n-h}else if(null!=c){d=c.dts-this._dtsBase-n-h}else d=m.length>=1?m[m.length-1].duration:Math.floor(this._videoMeta.refSampleDuration);if(o){let e=new Q(h,u,d,t.dts,!0);e.fileposition=t.fileposition,_.appendSyncPoint(e)}m.push({dts:h,pts:u,cts:l,units:t.units,size:t.length,isKeyframe:o,duration:d,originalDts:i,flags:{isLeading:0,dependsOn:o?2:1,isDependedOn:o?1:0,hasRedundancy:0,isNonSync:o?0:1}})}u=new Uint8Array(d),u[0]=d>>>24&255,u[1]=d>>>16&255,u[2]=d>>>8&255,u[3]=255&d,u.set(Z.types.mdat,4);for(let e=0;e<m.length;e++){let t=m[e].units;for(;t.length;){let e=t.shift().data;u.set(e,l),l+=e.byteLength}}let p=m[m.length-1];if(o=p.dts+p.duration,h=p.pts+p.duration,this._videoNextDts=o,_.beginDts=s,_.endDts=o,_.beginPts=a,_.endPts=h,_.originalBeginDts=m[0].originalDts,_.originalEndDts=p.originalDts+p.duration,_.firstSample=new Q(m[0].dts,m[0].pts,m[0].duration,m[0].originalDts,m[0].isKeyframe),_.lastSample=new Q(p.dts,p.pts,p.duration,p.originalDts,p.isKeyframe),this._isLive||this._videoSegmentInfoList.append(_),i.samples=m,i.sequenceNumber++,this._forceFirstIDR){let e=m[0].flags;e.dependsOn=2,e.isNonSync=0}let g=Z.moof(i,s);i.samples=[],i.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(g,u).buffer,sampleCount:m.length,info:_})}_mergeBoxes(e,t){let i=new Uint8Array(e.byteLength+t.byteLength);return i.set(e,0),i.set(t,e.byteLength),i}};var ne={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};var se=class{constructor(e,t){this.TAG="TransmuxingController",this._emitter=new u.a,this._config=t,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),"boolean"!=typeof e.cors&&(e.cors=!0),"boolean"!=typeof e.withCredentials&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;let i=0;this._mediaDataSource.segments.forEach(r=>{r.timestampBase=i,i+=r.duration,r.cors=e.cors,r.withCredentials=e.withCredentials,t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy)}),isNaN(i)||this._mediaDataSource.duration===i||(this._mediaDataSource.duration=i),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}destroy(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null}on(e,t){this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}start(){this._loadSegment(0),this._enableStatisticsReporter()}_loadSegment(e,t){this._currentSegmentIndex=e;let i=this._mediaDataSource.segments[e],r=this._ioctl=new k(i,this._config,e);r.onError=this._onIOException.bind(this),r.onSeeked=this._onIOSeeked.bind(this),r.onComplete=this._onIOComplete.bind(this),r.onRedirect=this._onIORedirect.bind(this),r.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?this._demuxer.bindDataSource(this._ioctl):r.onDataArrival=this._onInitChunkArrival.bind(this),r.open(t)}stop(){this._internalAbort(),this._disableStatisticsReporter()}_internalAbort(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)}pause(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())}resume(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())}seek(e){if(null==this._mediaInfo||!this._mediaInfo.isSeekable())return;let t=this._searchSegmentIndexContains(e);if(t===this._currentSegmentIndex){let i=this._mediaInfo.segments[t];if(null==i)this._pendingSeekTime=e;else{let t=i.getNearestKeyframe(e);this._remuxer.seek(t.milliseconds),this._ioctl.seek(t.fileposition),this._pendingResolveSeekPoint=t.milliseconds}}else{let i=this._mediaInfo.segments[t];if(null==i)this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(t);else{let r=i.getNearestKeyframe(e);this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[t].timestampBase,this._loadSegment(t,r.fileposition),this._pendingResolveSeekPoint=r.milliseconds,this._reportSegmentMediaInfo(t)}}this._enableStatisticsReporter()}_searchSegmentIndexContains(e){let t=this._mediaDataSource.segments,i=t.length-1;for(let r=0;r<t.length;r++)if(e<t[r].timestampBase){i=r-1;break}return i}_onInitChunkArrival(e,t){let i=null,r=0;if(t>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,r=this._demuxer.parseChunks(e,t);else if((i=Y.probe(e)).match){this._demuxer=new Y(i,this._config),this._remuxer||(this._remuxer=new re(this._config));let n=this._mediaDataSource;null==n.duration||isNaN(n.duration)||(this._demuxer.overridedDuration=n.duration),"boolean"==typeof n.hasAudio&&(this._demuxer.overridedHasAudio=n.hasAudio),"boolean"==typeof n.hasVideo&&(this._demuxer.overridedHasVideo=n.hasVideo),this._demuxer.timestampBase=n.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),r=this._demuxer.parseChunks(e,t)}else i=null,c.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(()=>{this._internalAbort()}),this._emitter.emit(ne.DEMUX_ERROR,q.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),r=0;return r}_onMediaInfo(e){null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,P.prototype));let t=Object.assign({},e);Object.setPrototypeOf(t,P.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=t,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then(()=>{let e=this._pendingSeekTime;this._pendingSeekTime=null,this.seek(e)})}_onMetaDataArrived(e){this._emitter.emit(ne.METADATA_ARRIVED,e)}_onScriptDataArrived(e){this._emitter.emit(ne.SCRIPTDATA_ARRIVED,e)}_onIOSeeked(){this._remuxer.insertDiscontinuity()}_onIOComplete(e){let t=e+1;t<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(t)):(this._remuxer.flushStashedSamples(),this._emitter.emit(ne.LOADING_COMPLETE),this._disableStatisticsReporter())}_onIORedirect(e){let t=this._ioctl.extraData;this._mediaDataSource.segments[t].redirectedURL=e}_onIORecoveredEarlyEof(){this._emitter.emit(ne.RECOVERED_EARLY_EOF)}_onIOException(e,t){c.e(this.TAG,`IOException: type = ${e}, code = ${t.code}, msg = ${t.msg}`),self.postMessage({msg:"disconnect"}),this._emitter.emit(ne.IO_ERROR,e,t),this._disableStatisticsReporter()}_onDemuxException(e,t){c.e(this.TAG,`DemuxException: type = ${e}, info = ${t}`),this._emitter.emit(ne.DEMUX_ERROR,e,t)}_onRemuxerInitSegmentArrival(e,t){this._emitter.emit(ne.INIT_SEGMENT,e,t)}_onRemuxerMediaSegmentArrival(e,t){if(null==this._pendingSeekTime&&(this._emitter.emit(ne.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&"video"===e)){let e=t.info.syncPoints,i=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,b.safari&&e.length>0&&e[0].originalDts===i&&(i=e[0].pts),this._emitter.emit(ne.RECOMMEND_SEEKPOINT,i)}}_enableStatisticsReporter(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))}_disableStatisticsReporter(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}_reportSegmentMediaInfo(e){let t=this._mediaInfo.segments[e],i=Object.assign({},t);i.duration=this._mediaInfo.duration,i.segmentCount=this._mediaInfo.segmentCount,delete i.segments,delete i.keyframesIndex,this._emitter.emit(ne.MEDIA_INFO,i)}_reportStatisticsInfo(){let e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(ne.STATISTICS_INFO,e)}};var oe=function(e){let t=null,i=function(t,i){e.postMessage({msg:"logcat_callback",data:{type:t,logcat:i}})}.bind(this);function r(t,i){let r={msg:ne.INIT_SEGMENT,data:{type:t,data:i}};e.postMessage(r,[i.data])}function n(t,i){let r={msg:ne.MEDIA_SEGMENT,data:{type:t,data:i}};e.postMessage(r,[i.data])}function s(){let t={msg:ne.LOADING_COMPLETE};e.postMessage(t)}function o(){let t={msg:ne.RECOVERED_EARLY_EOF};e.postMessage(t)}function a(t){let i={msg:ne.MEDIA_INFO,data:t};e.postMessage(i)}function l(t){let i={msg:ne.METADATA_ARRIVED,data:t};e.postMessage(i)}function u(t){let i={msg:ne.SCRIPTDATA_ARRIVED,data:t};e.postMessage(i)}function d(t){let i={msg:ne.STATISTICS_INFO,data:t};e.postMessage(i)}function c(t,i){e.postMessage({msg:ne.IO_ERROR,data:{type:t,info:i}})}function f(t,i){e.postMessage({msg:ne.DEMUX_ERROR,data:{type:t,info:i}})}function _(t){e.postMessage({msg:ne.RECOMMEND_SEEKPOINT,data:t})}h.install(),e.addEventListener("message",(function(h){switch(h.data.cmd){case"init":t=new se(h.data.param[0],h.data.param[1]),t.on(ne.IO_ERROR,c.bind(this)),t.on(ne.DEMUX_ERROR,f.bind(this)),t.on(ne.INIT_SEGMENT,r.bind(this)),t.on(ne.MEDIA_SEGMENT,n.bind(this)),t.on(ne.LOADING_COMPLETE,s.bind(this)),t.on(ne.RECOVERED_EARLY_EOF,o.bind(this)),t.on(ne.MEDIA_INFO,a.bind(this)),t.on(ne.METADATA_ARRIVED,l.bind(this)),t.on(ne.SCRIPTDATA_ARRIVED,u.bind(this)),t.on(ne.STATISTICS_INFO,d.bind(this)),t.on(ne.RECOMMEND_SEEKPOINT,_.bind(this));break;case"destroy":t&&(t.destroy(),t=null),e.postMessage({msg:"destroyed"});break;case"start":t.start();break;case"stop":t.stop();break;case"seek":t.seek(h.data.param);break;case"pause":t.pause();break;case"resume":t.resume();break;case"logging_config":{let e=h.data.param;U.applyConfig(e),!0===e.enableCallback?U.addLogListener(i):U.removeLogListener(i);break}}}))};var ae=class{constructor(e,t){if(this.TAG="Transmuxer",this._emitter=new u.a,t.enableWorker&&"undefined"!=typeof Worker)try{let r=i(93);this._worker=r(oe),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[e,t]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},U.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:U.getConfig()})}catch(i){c.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new se(e,t)}else this._controller=new se(e,t);if(this._controller){let e=this._controller;e.on(ne.IO_ERROR,this._onIOError.bind(this)),e.on(ne.DEMUX_ERROR,this._onDemuxError.bind(this)),e.on(ne.INIT_SEGMENT,this._onInitSegment.bind(this)),e.on(ne.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),e.on(ne.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),e.on(ne.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),e.on(ne.MEDIA_INFO,this._onMediaInfo.bind(this)),e.on(ne.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),e.on(ne.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),e.on(ne.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),e.on(ne.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}destroy(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),U.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null}on(e,t){this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}hasWorker(){return null!=this._worker}open(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()}close(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()}seek(e){this._worker?this._worker.postMessage({cmd:"seek",param:e}):this._controller.seek(e)}pause(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()}resume(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()}_onInitSegment(e,t){Promise.resolve().then(()=>{this._emitter.emit(ne.INIT_SEGMENT,e,t)})}_onMediaSegment(e,t){Promise.resolve().then(()=>{this._emitter.emit(ne.MEDIA_SEGMENT,e,t)})}_onLoadingComplete(){Promise.resolve().then(()=>{this._emitter.emit(ne.LOADING_COMPLETE)})}_onRecoveredEarlyEof(){Promise.resolve().then(()=>{this._emitter.emit(ne.RECOVERED_EARLY_EOF)})}_onMediaInfo(e){Promise.resolve().then(()=>{this._emitter.emit(ne.MEDIA_INFO,e)})}_onMetaDataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(ne.METADATA_ARRIVED,e)})}_onScriptDataArrived(e){Promise.resolve().then(()=>{this._emitter.emit(ne.SCRIPTDATA_ARRIVED,e)})}_onStatisticsInfo(e){Promise.resolve().then(()=>{this._emitter.emit(ne.STATISTICS_INFO,e)})}_onIOError(e,t){Promise.resolve().then(()=>{this._emitter.emit(ne.IO_ERROR,e,t)})}_onDemuxError(e,t){Promise.resolve().then(()=>{this._emitter.emit(ne.DEMUX_ERROR,e,t)})}_onRecommendSeekpoint(e){Promise.resolve().then(()=>{this._emitter.emit(ne.RECOMMEND_SEEKPOINT,e)})}_onLoggingConfigChanged(e){this._worker&&this._worker.postMessage({cmd:"logging_config",param:e})}_onWorkerMessage(e){let t=e.data,i=t.data;if("destroyed"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case ne.INIT_SEGMENT:case ne.MEDIA_SEGMENT:this._emitter.emit(t.msg,i.type,i.data);break;case ne.LOADING_COMPLETE:case ne.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case ne.MEDIA_INFO:Object.setPrototypeOf(i,P.prototype),this._emitter.emit(t.msg,i);break;case ne.METADATA_ARRIVED:case ne.SCRIPTDATA_ARRIVED:case ne.STATISTICS_INFO:this._emitter.emit(t.msg,i);break;case ne.IO_ERROR:case ne.DEMUX_ERROR:this._emitter.emit(t.msg,i.type,i.info);break;case ne.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,i);break;case"logcat_callback":c.emitter.emit("log",i.type,i.logcat);break;case"disconnect":window.postMessage({action:"disconnect"},"*")}}};var he={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};var le=class{constructor(e){this.TAG="MSEController",this._config=e,this._emitter=new u.a,this._config.isLive&&null==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new te}destroy(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null}on(e,t){this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}attachMediaElement(e){if(this._mediaSource)throw new m("MediaSource has been attached to an HTMLMediaElement!");let t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL}detachMediaElement(){if(this._mediaSource){let e=this._mediaSource;for(let t in this._sourceBuffers){let i=this._pendingSegments[t];i.splice(0,i.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;let r=this._sourceBuffers[t];if(r){if("closed"!==e.readyState){try{e.removeSourceBuffer(r)}catch(e){c.e(this.TAG,e.message)}r.removeEventListener("error",this.e.onSourceBufferError),r.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if("open"===e.readyState)try{e.endOfStream()}catch(e){c.e(this.TAG,e.message)}e.removeEventListener("sourceopen",this.e.onSourceOpen),e.removeEventListener("sourceended",this.e.onSourceEnded),e.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement,this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)}appendInitSegment(e,t){if(!this._mediaSource||"open"!==this._mediaSource.readyState)return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);let i=e,r=""+i.container;i.codec&&i.codec.length>0&&(r+=";codecs="+i.codec);let n=!1;if(c.v(this.TAG,"Received Initialization Segment, mimeType: "+r),this._lastInitSegments[i.type]=i,r!==this._mimeTypes[i.type]){if(this._mimeTypes[i.type])c.v(this.TAG,`Notice: ${i.type} mimeType changed, origin: ${this._mimeTypes[i.type]}, target: ${r}`);else{n=!0;try{let e=this._sourceBuffers[i.type]=this._mediaSource.addSourceBuffer(r);e.addEventListener("error",this.e.onSourceBufferError),e.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(e){return c.e(this.TAG,e.message),void this._emitter.emit(he.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[i.type]=r}t||this._pendingSegments[i.type].push(i),n||this._sourceBuffers[i.type]&&!this._sourceBuffers[i.type].updating&&this._doAppendSegments(),b.safari&&"audio/mpeg"===i.container&&i.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=i.mediaDuration/1e3,this._updateMediaSourceDuration())}appendMediaSegment(e){let t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();let i=this._sourceBuffers[t.type];!i||i.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()}seek(e){for(let e in this._sourceBuffers){if(!this._sourceBuffers[e])continue;let t=this._sourceBuffers[e];if("open"===this._mediaSource.readyState)try{t.abort()}catch(e){c.e(this.TAG,e.message)}this._idrList.clear();let i=this._pendingSegments[e];if(i.splice(0,i.length),"closed"!==this._mediaSource.readyState){for(let i=0;i<t.buffered.length;i++){let r=t.buffered.start(i),n=t.buffered.end(i);this._pendingRemoveRanges[e].push({start:r,end:n})}if(t.updating||this._doRemoveRanges(),b.safari){let i=this._lastInitSegments[e];i&&(this._pendingSegments[e].push(i),t.updating||this._doAppendSegments())}}}}endOfStream(){let e=this._mediaSource,t=this._sourceBuffers;e&&"open"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&"closed"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)}getNearestKeyframe(e){return this._idrList.getLastSyncPointBeforeDts(e)}_needCleanupSourceBuffer(){if(!this._config.autoCleanupSourceBuffer)return!1;let e=this._mediaElement.currentTime;for(let t in this._sourceBuffers){let i=this._sourceBuffers[t];if(i){let t=i.buffered;if(t.length>=1&&e-t.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1}_doCleanupSourceBuffer(){let e=this._mediaElement.currentTime;for(let t in this._sourceBuffers){let i=this._sourceBuffers[t];if(i){let r=i.buffered,n=!1;for(let i=0;i<r.length;i++){let s=r.start(i),o=r.end(i);if(s<=e&&e<o+3){if(e-s>=this._config.autoCleanupMaxBackwardDuration){n=!0;let i=e-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:s,end:i})}}else o<e&&(n=!0,this._pendingRemoveRanges[t].push({start:s,end:o}))}n&&!i.updating&&this._doRemoveRanges()}}}_updateMediaSourceDuration(){let e=this._sourceBuffers;if(0===this._mediaElement.readyState||"open"!==this._mediaSource.readyState)return;if(e.video&&e.video.updating||e.audio&&e.audio.updating)return;let t=this._mediaSource.duration,i=this._pendingMediaDuration;i>0&&(isNaN(t)||i>t)&&(c.v(this.TAG,`Update MediaSource duration from ${t} to ${i}`),this._mediaSource.duration=i),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}_doRemoveRanges(){for(let e in this._pendingRemoveRanges){if(!this._sourceBuffers[e]||this._sourceBuffers[e].updating)continue;let t=this._sourceBuffers[e],i=this._pendingRemoveRanges[e];for(;i.length&&!t.updating;){let e=i.shift();t.remove(e.start,e.end)}}}_doAppendSegments(){let e=this._pendingSegments;for(let t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&e[t].length>0){let i=e[t].shift();if(i.timestampOffset){let e=this._sourceBuffers[t].timestampOffset,r=i.timestampOffset/1e3;Math.abs(e-r)>.1&&(c.v(this.TAG,`Update MPEG audio timestampOffset from ${e} to ${r}`),this._sourceBuffers[t].timestampOffset=r),delete i.timestampOffset}if(!i.data||0===i.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(i.data),this._isBufferFull=!1,"video"===t&&i.hasOwnProperty("info")&&this._idrList.appendArray(i.info.syncPoints)}catch(e){this._pendingSegments[t].unshift(i),22===e.code?(this._isBufferFull||this._emitter.emit(he.BUFFER_FULL),this._isBufferFull=!0):(c.e(this.TAG,e.message),this._emitter.emit(he.ERROR,{code:e.code,msg:e.message}))}}}_onSourceOpen(){if(c.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0){let e=this._pendingSourceBufferInit;for(;e.length;){let t=e.shift();this.appendInitSegment(t,!0)}}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(he.SOURCE_OPEN)}_onSourceEnded(){c.v(this.TAG,"MediaSource onSourceEnded")}_onSourceClose(){c.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))}_hasPendingSegments(){let e=this._pendingSegments;return e.video.length>0||e.audio.length>0}_hasPendingRemoveRanges(){let e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0}_onSourceBufferUpdateEnd(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(he.UPDATE_END)}_onSourceBufferError(e){c.e(this.TAG,"SourceBuffer Error: "+e)}};const ue={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},de={NETWORK_EXCEPTION:y.EXCEPTION,NETWORK_STATUS_CODE_INVALID:y.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:y.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:y.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:q.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:q.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:q.CODEC_UNSUPPORTED};var ce=class{constructor(e,t){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new u.a,this._config=C(),"object"==typeof t&&Object.assign(this._config,t),"flv"!==e.type.toLowerCase())throw new p("FlvPlayer requires an flv MediaDataSource input!");!0===e.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=e,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;let i=b.chrome&&(b.version.major<50||50===b.version.major&&b.version.build<2661);this._alwaysSeekKeyframe=!!(i||b.msedge||b.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}destroy(){null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}on(e,t){e===M.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then(()=>{this._emitter.emit(M.MEDIA_INFO,this.mediaInfo)}):e===M.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then(()=>{this._emitter.emit(M.STATISTICS_INFO,this.statisticsInfo)}),this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}attachMediaElement(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),e.addEventListener("seeking",this.e.onvSeeking),e.addEventListener("canplay",this.e.onvCanPlay),e.addEventListener("stalled",this.e.onvStalled),e.addEventListener("progress",this.e.onvProgress),this._msectl=new le(this._config),this._msectl.on(he.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(he.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(he.SOURCE_OPEN,()=>{this._mseSourceOpened=!0,this._hasPendingLoad&&(this._hasPendingLoad=!1,this.load())}),this._msectl.on(he.ERROR,e=>{this._emitter.emit(M.ERROR,ue.MEDIA_ERROR,de.MEDIA_MSE_ERROR,e)}),this._msectl.attachMediaElement(e),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}detachMediaElement(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)}load(){if(!this._mediaElement)throw new m("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new m("FlvPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(this._config.deferLoadAfterSourceOpen&&!1===this._mseSourceOpened?this._hasPendingLoad=!0:(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new ae(this._mediaDataSource,this._config),this._transmuxer.on(ne.INIT_SEGMENT,(e,t)=>{this._msectl.appendInitSegment(t)}),this._transmuxer.on(ne.MEDIA_SEGMENT,(e,t)=>{if(this._msectl.appendMediaSegment(t),this._config.lazyLoad&&!this._config.isLive){let e=this._mediaElement.currentTime;t.info.endDts>=1e3*(e+this._config.lazyLoadMaxDuration)&&null==this._progressChecker&&(c.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}}),this._transmuxer.on(ne.LOADING_COMPLETE,()=>{this._msectl.endOfStream(),this._emitter.emit(M.LOADING_COMPLETE)}),this._transmuxer.on(ne.RECOVERED_EARLY_EOF,()=>{this._emitter.emit(M.RECOVERED_EARLY_EOF)}),this._transmuxer.on(ne.IO_ERROR,(e,t)=>{this._emitter.emit(M.ERROR,ue.NETWORK_ERROR,e,t)}),this._transmuxer.on(ne.DEMUX_ERROR,(e,t)=>{this._emitter.emit(M.ERROR,ue.MEDIA_ERROR,e,{code:-1,msg:t})}),this._transmuxer.on(ne.MEDIA_INFO,e=>{this._mediaInfo=e,this._emitter.emit(M.MEDIA_INFO,Object.assign({},e))}),this._transmuxer.on(ne.METADATA_ARRIVED,e=>{this._emitter.emit(M.METADATA_ARRIVED,e)}),this._transmuxer.on(ne.SCRIPTDATA_ARRIVED,e=>{this._emitter.emit(M.SCRIPTDATA_ARRIVED,e)}),this._transmuxer.on(ne.STATISTICS_INFO,e=>{this._statisticsInfo=this._fillStatisticsInfo(e),this._emitter.emit(M.STATISTICS_INFO,Object.assign({},this._statisticsInfo))}),this._transmuxer.on(ne.RECOMMEND_SEEKPOINT,e=>{this._mediaElement&&!this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e/1e3)}),this._transmuxer.open()))}unload(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)}play(){return this._mediaElement.play()}pause(){this._mediaElement.pause()}get type(){return this._type}get buffered(){return this._mediaElement.buffered}get duration(){return this._mediaElement.duration}get volume(){return this._mediaElement.volume}set volume(e){this._mediaElement.volume=e}get muted(){return this._mediaElement.muted}set muted(e){this._mediaElement.muted=e}get currentTime(){return this._mediaElement?this._mediaElement.currentTime:0}set currentTime(e){this._mediaElement?this._internalSeek(e):this._pendingSeekTime=e}get mediaInfo(){return Object.assign({},this._mediaInfo)}get statisticsInfo(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)}_fillStatisticsInfo(e){if(e.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return e;let t=!0,i=0,r=0;if(this._mediaElement.getVideoPlaybackQuality){let e=this._mediaElement.getVideoPlaybackQuality();i=e.totalVideoFrames,r=e.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(i=this._mediaElement.webkitDecodedFrameCount,r=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=r),e}_onmseUpdateEnd(){if(!this._config.lazyLoad||this._config.isLive)return;let e=this._mediaElement.buffered,t=this._mediaElement.currentTime,i=0,r=0;for(let n=0;n<e.length;n++){let s=e.start(n),o=e.end(n);if(s<=t&&t<o){i=s,r=o;break}}r>=t+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(c.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}_onmseBufferFull(){c.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer()}_suspendTransmuxer(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))}_checkProgressAndResume(){let e=this._mediaElement.currentTime,t=this._mediaElement.buffered,i=!1;for(let r=0;r<t.length;r++){let n=t.start(r),s=t.end(r);if(e>=n&&e<s){e>=s-this._config.lazyLoadRecoverDuration&&(i=!0);break}}i&&(window.clearInterval(this._progressChecker),this._progressChecker=null,i&&(c.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))}_isTimepointBuffered(e){let t=this._mediaElement.buffered;for(let i=0;i<t.length;i++){let r=t.start(i),n=t.end(i);if(e>=r&&e<n)return!0}return!1}_internalSeek(e){let t=this._isTimepointBuffered(e),i=!1,r=0;if(e<1&&this._mediaElement.buffered.length>0){let t=this._mediaElement.buffered.start(0);(t<1&&e<t||b.safari)&&(i=!0,r=b.safari?.1:t)}if(i)this._requestSetTime=!0,this._mediaElement.currentTime=r;else if(t){if(this._alwaysSeekKeyframe){let t=this._msectl.getNearestKeyframe(Math.floor(1e3*e));this._requestSetTime=!0,this._mediaElement.currentTime=null!=t?t.dts/1e3:e}else this._requestSetTime=!0,this._mediaElement.currentTime=e;null!=this._progressChecker&&this._checkProgressAndResume()}else null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e)}_checkAndApplyUnbufferedSeekpoint(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){let e=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(e)||(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}_checkAndResumeStuckPlayback(e){let t=this._mediaElement;if(e||!this._receivedCanPlay||t.readyState<2){let e=t.buffered;e.length>0&&t.currentTime<e.start(0)&&(c.w(this.TAG,`Playback seems stuck at ${t.currentTime}, seek to ${e.start(0)}`),this._requestSetTime=!0,this._mediaElement.currentTime=e.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)}_onvLoadedMetadata(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)}_onvSeeking(e){let t=this._mediaElement.currentTime,i=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(t<1&&i.length>0){let e=i.start(0);if(e<1&&t<e||b.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=b.safari?.1:e)}if(this._isTimepointBuffered(t)){if(this._alwaysSeekKeyframe){let e=this._msectl.getNearestKeyframe(Math.floor(1e3*t));null!=e&&(this._requestSetTime=!0,this._mediaElement.currentTime=e.dts/1e3)}null!=this._progressChecker&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:t,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}}_onvCanPlay(e){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)}_onvStalled(e){this._checkAndResumeStuckPlayback(!0)}_onvProgress(e){this._checkAndResumeStuckPlayback()}};var fe=class{constructor(e,t){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new u.a,this._config=C(),"object"==typeof t&&Object.assign(this._config,t),"flv"===e.type.toLowerCase())throw new p("NativePlayer does't support flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new p(`NativePlayer(${e.type}) doesn't support multipart playback!`);this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}destroy(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null}on(e,t){e===M.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(()=>{this._emitter.emit(M.MEDIA_INFO,this.mediaInfo)}):e===M.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then(()=>{this._emitter.emit(M.STATISTICS_INFO,this.statisticsInfo)}),this._emitter.addListener(e,t)}off(e,t){this._emitter.removeListener(e,t)}attachMediaElement(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}}detachMediaElement(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}load(){if(!this._mediaElement)throw new m("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)}unload(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)}play(){return this._mediaElement.play()}pause(){this._mediaElement.pause()}get type(){return this._type}get buffered(){return this._mediaElement.buffered}get duration(){return this._mediaElement.duration}get volume(){return this._mediaElement.volume}set volume(e){this._mediaElement.volume=e}get muted(){return this._mediaElement.muted}set muted(e){this._mediaElement.muted=e}get currentTime(){return this._mediaElement?this._mediaElement.currentTime:0}set currentTime(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e}get mediaInfo(){let e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e}get statisticsInfo(){let e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;let t=!0,i=0,r=0;if(this._mediaElement.getVideoPlaybackQuality){let e=this._mediaElement.getVideoPlaybackQuality();i=e.totalVideoFrames,r=e.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(i=this._mediaElement.webkitDecodedFrameCount,r=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=i,e.droppedFrames=r),e}_onvLoadedMetadata(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(M.MEDIA_INFO,this.mediaInfo)}_reportStatisticsInfo(){this._emitter.emit(M.STATISTICS_INFO,this.statisticsInfo)}};h.install();let _e={createPlayer:function(e,t){let i=e;if(null==i||"object"!=typeof i)throw new p("MediaDataSource must be an javascript object!");if(!i.hasOwnProperty("type"))throw new p("MediaDataSource must has type field to indicate video file type!");switch(i.type){case"flv":return new ce(i,t);default:return new fe(i,t)}},isSupported:function(){return D.supportMSEH264Playback()},getFeatureList:function(){return D.getFeatureList()}};_e.BaseLoader=E,_e.LoaderStatus=v,_e.LoaderErrors=y,_e.Events=M,_e.ErrorTypes=ue,_e.ErrorDetails=de,_e.FlvPlayer=ce,_e.NativePlayer=fe,_e.LoggingControl=U,Object.defineProperty(_e,"version",{enumerable:!0,get:function(){return"__VERSION__"}});var me=_e;i(55),i(59),i(60);function pe(e,t,i,r,n,s,o){try{var a=e[s](o),h=a.value}catch(e){return void i(e)}a.done?t(h):Promise.resolve(h).then(r,n)}function ge(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var s=e.apply(t,i);function o(e){pe(s,r,n,o,a,"next",e)}function a(e){pe(s,r,n,o,a,"throw",e)}o(void 0)}))}}var ve=function(e,t){return ge(regeneratorRuntime.mark((function i(){var r;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,fetch(e,{body:JSON.stringify(t),method:"POST",headers:{"content-type":"application/json",Accept:"application/json"},credentials:"include"});case 2:if(!(r=i.sent).ok){i.next=7;break}return i.abrupt("return",r.json());case 7:return console.error(r.json().message),i.abrupt("return",Promise.reject());case 9:case"end":return i.stop()}}),i)})))()},ye=function(e,t){return ge(regeneratorRuntime.mark((function i(){var r;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,fetch(e,{body:JSON.stringify(t),method:"POST",headers:{"content-type":"application/json",Accept:"application/json"},credentials:"include"});case 2:if(!(r=i.sent).ok){i.next=7;break}return i.abrupt("return",r.json());case 7:return console.error(r.json().message),i.abrupt("return",Promise.reject());case 9:case"end":return i.stop()}}),i)})))()},Ee=function(e,t){return ge(regeneratorRuntime.mark((function i(){var r;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,fetch(e,{body:JSON.stringify(t),method:"POST",headers:{"content-type":"application/json",Accept:"application/json"},credentials:"include"});case 2:if(!(r=i.sent).ok){i.next=7;break}return i.abrupt("return",r.json());case 7:return console.error(r.json().message),i.abrupt("return",Promise.reject());case 9:case"end":return i.stop()}}),i)})))()};function Se(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var be=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.stream=i.stream,this.reconnectServer=this.reconnectServer,this.appId=i.appId,this.deviceId=i.deviceId,this.renderVideo(),this.createPlayer(),this._eventListener()}var t,i,s;return t=e,(i=[{key:"renderVideo",value:function(){this.container.innerHTML="<div style='position: absolute;left: 50%;top: 50%;transform: translate(-50%, -50%);width: 100%;height: 100%;'><video id='player' style='width: 100%;height: 100%;background-color: #000;' muted>Your browser is too old which doesn't support HTML5 video.</video></div>",this.ePlayer=document.getElementById("player"),this.ePlayer.oncontextmenu=function(){return!1}}},{key:"createPlayer",value:function(){me.isSupported()&&(this.pInstance&&this.destory(),r(this.stream)&&(this.pInstance=me.createPlayer({type:"flv",url:this.stream,hasVideo:!0,hasAudio:!1,isLive:!0,cors:!0},{enableWorker:!0,enableStashBuffer:!1,stashInitialSize:120,autoCleanupSourceBuffer:!0,autoCleanupMaxBackwardDuration:5,autoCleanupMinBackwardDuration:3,lazyLoadMaxDuration:180,seekType:"range"}),this.pInstance.attachMediaElement(this.ePlayer),this.pInstance.load(),this.pInstance.play()))}},{key:"load",value:function(){this.pInstance&&this.pInstance.load()}},{key:"start",value:function(){this.pInstance&&this.pInstance.play()}},{key:"pause",value:function(){this.pInstance&&this.pInstance.pause()}},{key:"replaceStream",value:function(e,t,i){this.stream=e,this.appId=i,this.deviceId=t,this.createPlayer()}},{key:"reconnect",value:function(){var e=this,t=0,i=setInterval((function(){console.info(++t+"times reconnect..."),ve(e.reconnectServer,{appId:e.appId,deviceId:e.deviceId,type:"flv"}).then((function(r){e.stream=r.data[0].playUrl,e.createPlayer(),t>100&&i&&clearInterval(i)}))}),2e3)}},{key:"getCurrentTime",value:function(){return this.ePlayer.currentTime}},{key:"screenshot",value:function(){var e=document.createElement("canvas");e.width=this.ePlayer.videoWidth,e.height=this.ePlayer.videoHeight,e.getContext("2d").drawImage(this.ePlayer,0,0,this.ePlayer.videoWidth,this.ePlayer.videoHeight);var t=e.toDataURL("image/png"),i=document.createElement("a"),r=n(t);return i.download="截图.png",i.href=URL.createObjectURL(r),i.click(),t}},{key:"destory",value:function(){this.pInstance&&this.pInstance.pause(),this.pInstance&&this.pInstance.unload(),this.pInstance&&this.pInstance.detachMediaElement(),this.pInstance&&this.pInstance.destroy(),this.pInstance=null}},{key:"_eventListener",value:function(){var e=this;window.addEventListener("message",(function(t){switch(t.data.action){case"disconnect":e.reconnect()}}),!1)}}])&&Se(t.prototype,i),s&&Se(t,s),e}();i(100);function we(e,t,i,r,n,s,o){try{var a=e[s](o),h=a.value}catch(e){return void i(e)}a.done?t(h):Promise.resolve(h).then(r,n)}function Ae(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Re=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.startServer=i.startServer,this.stopServer=i.stopServer,this.deviceId=i.deviceId,this.appId=i.appId,this.streamType=i.streamType,this.beginTimeStamp=i.beginTimeStamp,this.endTimeStamp=i.endTimeStamp,this.currentTime=0,this.getStream(this.beginTimeStamp,this.endTimeStamp),this.renderVideo(),this._eventListener()}var t,i,a,h,l;return t=e,(i=[{key:"getStream",value:(h=regeneratorRuntime.mark((function e(t,i){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.sessionId,!e.t0){e.next=4;break}return e.next=4,this.stopStream();case 4:ye(this.startServer,{deviceId:this.deviceId,start:t,end:i,type:this.streamType,recordType:this.recordType,saveType:this.saveType}).then((function(e){"SUCCESS"===e.errorCode?(r.sessionId=e.data[0].sessionId,r.stream=e.data[0].playUrl,console.log(r.stream),r.createPlayer()):console.error(e.errorCode)}));case 5:case"end":return e.stop()}}),e,this)})),l=function(){var e=this,t=arguments;return new Promise((function(i,r){var n=h.apply(e,t);function s(e){we(n,i,r,s,o,"next",e)}function o(e){we(n,i,r,s,o,"throw",e)}s(void 0)}))},function(e,t){return l.apply(this,arguments)})},{key:"stopStream",value:function(){var e=this;Ee(this.stopServer,{deviceId:this.deviceId,sessionId:this.sessionId}).then((function(t){"SUCCESS"===t.errorCode?clearInterval(e.interval):console.error(t.errorCode)}))}},{key:"renderVideo",value:function(){this.container.innerHTML="<div style='position: absolute;left: 50%;top: 50%;transform: translate(-50%, -50%);width: 100%;height: 100%;'><video id='player' style='width: 100%;height: 100%;background-color: #000;' muted>Your browser is too old which doesn't support HTML5 video.</video><div id='controls' style='position: fixed;bottom: 0;width: 100%;height: 30px;box-sizing: border-box;padding: 0 20px;display: flex;flex-flow: nowrap row;justify-content: space-between;align-items: center;background-color: rgba(0, 0, 0, 0.45);opacity: 0;transition: opacity .8s;'><div id='progress-groove' style='position: relative;width: 80%;height: 20%;border-radius: 5px;background-color: #fff;padding: 0 2px;display: flex;flex-flow: nowrap row;justify-content: flex-start;align-items: center;'><div id='progress-bar' style='height: 60%;background-color: #00A2E8;border-radius: 3px;'></div></div><div id='time' style='color: #fff;'></div></div></div>",this.controlsEle=document.getElementById("controls"),this.controlsEle.onmouseenter=this.showControls.bind(this),this.controlsEle.onmouseleave=this.hideControls.bind(this),this.controlsEle.onclick=this.updateProgress.bind(this),this.ePlayer=document.getElementById("player"),this.ePlayer.oncontextmenu=function(){return!1},this.ePlayer.onloadeddata=this.onloadeddata.bind(this),this.progressBarTotalWidth=document.getElementById("progress-groove").clientWidth,this.progressBarEle=document.getElementById("progress-bar"),this.timeEle=document.getElementById("time")}},{key:"onloadeddata",value:function(){this.interval&&clearInterval(this.interval),this.interval=setInterval(this.renderProgress.bind(this),300)}},{key:"showControls",value:function(){this.timeout&&clearTimeout(this.timeout),this.controlsEle.style.opacity=1}},{key:"hideControls",value:function(){var e=this;this.timeout=setTimeout((function(){e.controlsEle.style.opacity=0}),3e3)}},{key:"updateProgress",value:function(e){e.stopPropagation(),this.currentTime=e.offsetX/this.progressBarTotalWidth*(this.endTimeStamp-this.beginTimeStamp),this.progressBarEle.style.width=e.offsetX+"px",this.getStream(this.beginTimeStamp+this.currentTime,this.endTimeStamp)}},{key:"renderProgress",value:function(){var e=this.currentTime+this.ePlayer.currentTime;this.percent=o(this.beginTimeStamp,this.endTimeStamp,e),this.timeEle.innerHTML="".concat(s(Math.ceil(this.beginTimeStamp+e))," / ").concat(s(Math.ceil(this.endTimeStamp))),this.progressBarEle.style.width=this.percent*this.progressBarTotalWidth+"px",this.endTimeStamp-this.beginTimeStamp-e<1&&clearInterval(this.interval)}},{key:"createPlayer",value:function(){me.isSupported()&&(this.pInstance&&this.destory(),r(this.stream)&&(this.pInstance=me.createPlayer({type:"flv",url:this.stream,hasVideo:!0,hasAudio:!1,isLive:!0,cors:!0},{enableWorker:!0,enableStashBuffer:!1,stashInitialSize:120,autoCleanupSourceBuffer:!0,autoCleanupMaxBackwardDuration:5,autoCleanupMinBackwardDuration:3,lazyLoadMaxDuration:180,seekType:"range"}),this.pInstance.attachMediaElement(this.ePlayer),this.pInstance.load(),this.pInstance.play()))}},{key:"load",value:function(){this.pInstance.load()}},{key:"start",value:function(){this.pInstance.play()}},{key:"pause",value:function(){this.pInstance.pause()}},{key:"replaceDevice",value:function(e,t){this.deviceId=e,this.appId=t,this.getStream(this.beginTimeStamp,this.endTimeStamp)}},{key:"reconnect",value:function(){var e=this;if(this.percent>.98)this.stopStream(),this.destory();else var t=0,i=setInterval((function(){console.info(++t+"times reconnect..."),ve(e.reconnectServer,{appId:e.appId,deviceId:e.deviceId,type:"flv"}).then((function(r){e.stream=r.data[0].playUrl,e.createPlayer(),t>100&&i&&clearInterval(i)}))}),2e3)}},{key:"getCurrentTime",value:function(){return this.currentTime+this.ePlayer.currentTime}},{key:"screenshot",value:function(){var e=document.createElement("canvas");e.width=this.ePlayer.videoWidth,e.height=this.ePlayer.videoHeight,e.getContext("2d").drawImage(this.ePlayer,0,0,this.ePlayer.videoWidth,this.ePlayer.videoHeight);var t=e.toDataURL("image/png"),i=document.createElement("a"),r=n(t);return i.download="截图.png",i.href=URL.createObjectURL(r),i.click(),t}},{key:"unrender",value:function(){document.removeChild(this.ePlayer)}},{key:"destory",value:function(){this.pInstance.pause(),this.pInstance.unload(),this.pInstance.detachMediaElement(),this.pInstance.destroy(),this.pInstance=null}},{key:"_eventListener",value:function(){var e=this;window.addEventListener("message",(function(t){switch(t.data.action){case"disconnect":e.reconnect()}}),!1)}}])&&Ae(t.prototype,i),a&&Ae(t,a),e}();t.default={createPlayer:function(e,t){if(!e)throw new Error("container dom is not present");var i=t.mode,r=t.options;if("real"===i){if(r.stream)return new be(e,Object.assign({stream:"",reconnectServer:"",appId:"",deviceId:""},r));throw new Error("stream is not present")}if("playback"===i){if(r.startServer&&r.stopServer&&r.deviceId&&r.beginTimeStamp&&r.endTimeStamp)return new Re(e,Object.assign({startServer:"",stopServer:"",deviceId:"",appId:"",beginTimeStamp:"",endTimeStamp:"",streamType:"flv",reconnectServer:"",recordType:"",saveType:""},r));throw new Error("params is not intact")}}}}]).default}));